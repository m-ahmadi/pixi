{"version":3,"sources":["../src/mainSocket.js"],"names":["define","u","inst","URL","ws","opened","callbacks","counter","isOpen","send","str","fn","isFn","onmessage","init","WebSocket","onopen","e","console","log","isStr","data","onerror","onclose","window","mainSocket"],"mappings":"AAAAA,OAAO,CAAC,WAAD,CAAP,EAAsB,UAAUC,CAAV,EAAa;AAClC,KAAIC,OAAO,EAAX;;AAEA,KAAMC,MAAM,iCAAZ;AACA,KAAIC,WAAJ;AACA,KAAIC,SAAS,KAAb;AACA,KAAIC,YAAY,EAAhB;AACA,KAAIC,UAAU,CAAd;;AAEA,UAASC,MAAT,GAAkB;AACjB,SAAOH,MAAP;AACA;AACD,UAASI,IAAT,CAAcC,GAAd,EAAmBC,EAAnB,EAAuB;AACtB,MAAKH,QAAL,EAAgB;AACf,OAAKP,EAAEW,IAAF,CAAOD,EAAP,CAAL,EAAkB;AACjBP,OAAGS,SAAH,GAAeF,EAAf;AACA;AACDP,MAAGK,IAAH,CAAQC,GAAR;AACA;AACD;AACD,UAASI,IAAT,GAAgB;AACfV,OAAK,IAAIW,SAAJ,CAAcZ,GAAd,CAAL;;AAEAC,KAAGY,MAAH,GAAY,UAAUC,CAAV,EAAa;AACxBC,WAAQC,GAAR,CAAY,oBAAZ,EAAkCF,CAAlC;AACAZ,YAAS,IAAT;AACA,GAHD;AAIAD,KAAGS,SAAH,GAAe,UAAUI,CAAV,EAAa;AAC3B,OAAKhB,EAAEmB,KAAF,CAAQH,EAAEI,IAAV,CAAL,EAAuB;AACtBH,YAAQC,GAAR,CAAY,yBAAZ,EAAuCF,EAAEI,IAAzC;AACA,IAFD,MAEO;AACNH,YAAQC,GAAR,CAAY,wBAAZ,EAAsCF,EAAEI,IAAxC;AACA;AACD,GAND;AAOAjB,KAAGkB,OAAH,GAAa,UAAUL,CAAV,EAAa;AACzBC,WAAQC,GAAR,CAAY,mBAAZ,EAAkCF,CAAlC;AACA,GAFD;AAGAb,KAAGmB,OAAH,GAAa,UAAUN,CAAV,EAAa;AACzBZ,YAAS,KAAT;AACAa,WAAQC,GAAR,CAAY,mBAAZ,EAAiCF,CAAjC;AACA,GAHD;AAKA;;AAEDf,MAAKM,MAAL,GAAcA,MAAd;AACAN,MAAKO,IAAL,GAAYA,IAAZ;AACAP,MAAKY,IAAL,GAAYA,IAAZ;;AAEAU,QAAOC,UAAP,GAAoBvB,IAApB;AACA,QAAOA,IAAP;AACA,CAlDD","file":"mainSocket.js","sourcesContent":["define([\"core/util\"], function (u) {\r\n\tlet inst = {};\r\n\t\r\n\tconst URL = \"ws://127.0.0.1:3000/socket/open\";\r\n\tlet ws;\r\n\tlet opened = false;\r\n\tlet callbacks = {};\r\n\tlet counter = 0;\r\n\t\r\n\tfunction isOpen() {\r\n\t\treturn opened;\r\n\t}\r\n\tfunction send(str, fn) {\r\n\t\tif ( isOpen() ) {\r\n\t\t\tif ( u.isFn(fn) ) {\r\n\t\t\t\tws.onmessage = fn;\r\n\t\t\t}\r\n\t\t\tws.send(str);\r\n\t\t}\r\n\t}\r\n\tfunction init() {\r\n\t\tws = new WebSocket(URL);\r\n\t\t\r\n\t\tws.onopen = function (e) {\r\n\t\t\tconsole.log(\"Connection open...\", e);\r\n\t\t\topened = true;\r\n\t\t};\r\n\t\tws.onmessage = function (e) {\r\n\t\t\tif ( u.isStr(e.data) ) {\r\n\t\t\t\tconsole.log(\"String message received\", e.data);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(\"Other message received\", e.data);\r\n\t\t\t}\r\n\t\t};\r\n\t\tws.onerror = function (e) {\r\n\t\t\tconsole.log(\"WebSocket Error: \" , e);\r\n\t\t};\r\n\t\tws.onclose = function (e) {\r\n\t\t\topened = false;\r\n\t\t\tconsole.log(\"Connection closed\", e);\r\n\t\t};\r\n\t\r\n\t}\r\n\t\r\n\tinst.isOpen = isOpen;\r\n\tinst.send = send;\r\n\tinst.init = init;\r\n\t\r\n\twindow.mainSocket = inst;\r\n\treturn inst;\r\n});"]}