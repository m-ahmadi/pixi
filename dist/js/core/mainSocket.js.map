{"version":3,"sources":["../../../src/js/core/mainSocket.js"],"names":["define","u","wuk","inst","URL","msg","PROCESS","SUCCESS","FAILED","DONE","note","ws","opened","isOpen","send","str","fn","isFn","onmessage","init","callback","callbackArgs","h1","h2","process","WebSocket","onopen","e","close","success","console","log","apply","undefined","info","isStr","data","onerror","error","onclose","window","mainSocket"],"mappings":"AAAAA,OAAO,CAAC,QAAD,EAAW,OAAX,CAAP,EAA4B,UAAUC,CAAV,EAAaC,GAAb,EAAkB;AAC7C,KAAIC,OAAO,EAAX;;AAEA,KAAMC,MAAM,iCAAZ;AACA,KAAMC,MAAM;AACXC,WAAS,sBADE;AAEXC,WAAS,+BAFE;AAGXC,UAAQ,gCAHG;AAIXC,QAAM;AAJK,EAAZ;AAMA,KAAMC,OAAOR,IAAIQ,IAAjB;;AAEA,KAAIC,WAAJ;AACA,KAAIC,SAAS,KAAb;;AAEA,UAASC,MAAT,GAAkB;AACjB,SAAOD,MAAP;AACA;AACD,UAASE,IAAT,CAAcC,GAAd,EAAmBC,EAAnB,EAAuB;AACtB,MAAKH,QAAL,EAAgB;AACf,OAAKZ,EAAEgB,IAAF,CAAOD,EAAP,CAAL,EAAkB;AACjBL,OAAGO,SAAH,GAAeF,EAAf;AACA;AACDL,MAAGG,IAAH,CAAQC,GAAR;AACA;AACD;AACD,UAASI,IAAT,CAAcC,QAAd,EAAwBC,YAAxB,EAAsC;AACrC,MAAIC,WAAJ;AAAA,MAAQC,WAAR;;AAEAD,OAAKZ,KAAKc,OAAL,CAAa,iCAAb,CAAL;AACAb,OAAK,IAAIc,SAAJ,CAAcrB,GAAd,CAAL;;AAEAO,KAAGe,MAAH,GAAY,UAAUC,CAAV,EAAa;AACxBL,MAAGM,KAAH;AACAlB,QAAKmB,OAAL,CAAa,sBAAb;AACAC,WAAQC,GAAR,CAAY,oBAAZ,EAAkCJ,CAAlC;AACAf,YAAS,IAAT;;AAEA,OAAKX,EAAEgB,IAAF,CAAOG,QAAP,CAAL,EAAwB;AACvBG,SAAKb,KAAKc,OAAL,CAAanB,IAAIC,OAAjB,CAAL;AACAc,aAASY,KAAT,CAAeC,SAAf,EAA0BZ,YAA1B;AACAE,OAAGK,KAAH;AACAlB,SAAKwB,IAAL,CAAU7B,IAAII,IAAd;AACA;AACD,GAZD;AAaAE,KAAGO,SAAH,GAAe,UAAUS,CAAV,EAAa;AAC3B,OAAK1B,EAAEkC,KAAF,CAAQR,EAAES,IAAV,CAAL,EAAuB;AACtBN,YAAQC,GAAR,CAAY,yBAAZ,EAAuCJ,EAAES,IAAzC;AACA,IAFD,MAEO;AACNN,YAAQC,GAAR,CAAY,wBAAZ,EAAsCJ,EAAES,IAAxC;AACA;AACD,GAND;AAOAzB,KAAG0B,OAAH,GAAa,UAAUV,CAAV,EAAa;AACzBL,MAAGM,KAAH;AACAlB,QAAK4B,KAAL,CAAW,gCAAX;AACAR,WAAQC,GAAR,CAAY,mBAAZ,EAAkCJ,CAAlC;AACA,GAJD;AAKAhB,KAAG4B,OAAH,GAAa,UAAUZ,CAAV,EAAa;AACzBf,YAAS,KAAT;AACAkB,WAAQC,GAAR,CAAY,mBAAZ,EAAiCJ,CAAjC;AACA,GAHD;AAKA;;AAEDxB,MAAKU,MAAL,GAAcA,MAAd;AACAV,MAAKW,IAAL,GAAYA,IAAZ;AACAX,MAAKgB,IAAL,GAAYA,IAAZ;;AAEAqB,QAAOC,UAAP,GAAoBtC,IAApB;AACA,QAAOA,IAAP;AACA,CAtED","file":"mainSocket.js","sourcesContent":["define([\"./util\", \"./wuk\"], function (u, wuk) {\r\n\tlet inst = {};\r\n\t\r\n\tconst URL = \"ws://127.0.0.1:3000/socket/open\";\r\n\tconst msg = {\r\n\t\tPROCESS: \"Performing action...\",\r\n\t\tSUCCESS: \"Action successfuly performed.\",\r\n\t\tFAILED: \"Action could not be performed.\",\r\n\t\tDONE: \"Done.\"\r\n\t};\r\n\tconst note = wuk.note;\r\n\t\r\n\tlet ws;\r\n\tlet opened = false;\r\n\t\r\n\tfunction isOpen() {\r\n\t\treturn opened;\r\n\t}\r\n\tfunction send(str, fn) {\r\n\t\tif ( isOpen() ) {\r\n\t\t\tif ( u.isFn(fn) ) {\r\n\t\t\t\tws.onmessage = fn;\r\n\t\t\t}\r\n\t\t\tws.send(str);\r\n\t\t}\r\n\t}\r\n\tfunction init(callback, callbackArgs) {\r\n\t\tlet h1, h2;\r\n\t\t\r\n\t\th1 = note.process(\"Opening WebSocket connection...\");\r\n\t\tws = new WebSocket(URL);\r\n\t\t\r\n\t\tws.onopen = function (e) {\r\n\t\t\th1.close();\r\n\t\t\tnote.success(\"WebSocket is opened.\");\r\n\t\t\tconsole.log(\"Connection open...\", e);\r\n\t\t\topened = true;\r\n\t\t\t\r\n\t\t\tif ( u.isFn(callback) ) {\r\n\t\t\t\th2 = note.process(msg.PROCESS);\r\n\t\t\t\tcallback.apply(undefined, callbackArgs);\r\n\t\t\t\th2.close();\r\n\t\t\t\tnote.info(msg.DONE);\r\n\t\t\t}\r\n\t\t};\r\n\t\tws.onmessage = function (e) {\r\n\t\t\tif ( u.isStr(e.data) ) {\r\n\t\t\t\tconsole.log(\"String message received\", e.data);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(\"Other message received\", e.data);\r\n\t\t\t}\r\n\t\t};\r\n\t\tws.onerror = function (e) {\r\n\t\t\th1.close();\r\n\t\t\tnote.error(\"WebSocket could not be opened.\");\r\n\t\t\tconsole.log(\"WebSocket Error: \" , e);\r\n\t\t};\r\n\t\tws.onclose = function (e) {\r\n\t\t\topened = false;\r\n\t\t\tconsole.log(\"Connection closed\", e);\r\n\t\t};\r\n\t\r\n\t}\r\n\t\r\n\tinst.isOpen = isOpen;\r\n\tinst.send = send;\r\n\tinst.init = init;\r\n\t\r\n\twindow.mainSocket = inst;\r\n\treturn inst;\r\n});"]}