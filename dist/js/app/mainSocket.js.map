{"version":3,"sources":["../../../src/js/app/mainSocket.js"],"names":["define","u","wuk","inst","URL","ws","opened","callbacks","counter","note","msg","PROCESS","SUCCESS","FAILED","DONE","isOpen","send","str","fn","isFn","onmessage","init","callback","callbackArgs","h1","h2","process","WebSocket","onopen","e","close","success","console","log","apply","undefined","info","isStr","data","onerror","error","onclose","window","mainSocket"],"mappings":"AAAAA,OAAO,CAAC,QAAD,EAAW,OAAX,CAAP,EAA4B,UAAUC,CAAV,EAAaC,GAAb,EAAkB;AAC7C,KAAIC,OAAO,EAAX;;AAEA,KAAMC,MAAM,iCAAZ;AACA,KAAIC,WAAJ;AACA,KAAIC,SAAS,KAAb;AACA,KAAIC,YAAY,EAAhB;AACA,KAAIC,UAAU,CAAd;AACA,KAAMC,OAAOP,IAAIO,IAAjB;AACA,KAAMC,MAAM;AACXC,WAAS,sBADE;AAEXC,WAAS,+BAFE;AAGXC,UAAQ,gCAHG;AAIXC,QAAM;AAJK,EAAZ;AAMA,UAASC,MAAT,GAAkB;AACjB,SAAOT,MAAP;AACA;AACD,UAASU,IAAT,CAAcC,GAAd,EAAmBC,EAAnB,EAAuB;AACtB,MAAKH,QAAL,EAAgB;AACf,OAAKd,EAAEkB,IAAF,CAAOD,EAAP,CAAL,EAAkB;AACjBb,OAAGe,SAAH,GAAeF,EAAf;AACA;AACDb,MAAGW,IAAH,CAAQC,GAAR;AACA;AACD;AACD,UAASI,IAAT,CAAcC,QAAd,EAAwBC,YAAxB,EAAsC;AACrC,MAAIC,WAAJ;AAAA,MAAQC,WAAR;;AAEAD,OAAKf,KAAKiB,OAAL,CAAa,iCAAb,CAAL;AACArB,OAAK,IAAIsB,SAAJ,CAAcvB,GAAd,CAAL;;AAEAC,KAAGuB,MAAH,GAAY,UAAUC,CAAV,EAAa;AACxBL,MAAGM,KAAH;AACArB,QAAKsB,OAAL,CAAa,sBAAb;AACAC,WAAQC,GAAR,CAAY,oBAAZ,EAAkCJ,CAAlC;AACAvB,YAAS,IAAT;;AAEA,OAAKL,EAAEkB,IAAF,CAAOG,QAAP,CAAL,EAAwB;AACvBG,SAAKhB,KAAKiB,OAAL,CAAahB,IAAIC,OAAjB,CAAL;AACAW,aAASY,KAAT,CAAeC,SAAf,EAA0BZ,YAA1B;AACAE,OAAGK,KAAH;AACArB,SAAK2B,IAAL,CAAU1B,IAAII,IAAd;AACA;AACD,GAZD;AAaAT,KAAGe,SAAH,GAAe,UAAUS,CAAV,EAAa;AAC3B,OAAK5B,EAAEoC,KAAF,CAAQR,EAAES,IAAV,CAAL,EAAuB;AACtBN,YAAQC,GAAR,CAAY,yBAAZ,EAAuCJ,EAAES,IAAzC;AACA,IAFD,MAEO;AACNN,YAAQC,GAAR,CAAY,wBAAZ,EAAsCJ,EAAES,IAAxC;AACA;AACD,GAND;AAOAjC,KAAGkC,OAAH,GAAa,UAAUV,CAAV,EAAa;AACzBL,MAAGM,KAAH;AACArB,QAAK+B,KAAL,CAAW,gCAAX;AACAR,WAAQC,GAAR,CAAY,mBAAZ,EAAkCJ,CAAlC;AACA,GAJD;AAKAxB,KAAGoC,OAAH,GAAa,UAAUZ,CAAV,EAAa;AACzBvB,YAAS,KAAT;AACA0B,WAAQC,GAAR,CAAY,mBAAZ,EAAiCJ,CAAjC;AACA,GAHD;AAKA;;AAED1B,MAAKY,MAAL,GAAcA,MAAd;AACAZ,MAAKa,IAAL,GAAYA,IAAZ;AACAb,MAAKkB,IAAL,GAAYA,IAAZ;;AAEAqB,QAAOC,UAAP,GAAoBxC,IAApB;AACA,QAAOA,IAAP;AACA,CAtED","file":"mainSocket.js","sourcesContent":["define([\"./util\", \"./wuk\"], function (u, wuk) {\r\n\tlet inst = {};\r\n\t\r\n\tconst URL = \"ws://127.0.0.1:3000/socket/open\";\r\n\tlet ws;\r\n\tlet opened = false;\r\n\tlet callbacks = {};\r\n\tlet counter = 0;\r\n\tconst note = wuk.note;\r\n\tconst msg = {\r\n\t\tPROCESS: \"Performing action...\",\r\n\t\tSUCCESS: \"Action successfuly performed.\",\r\n\t\tFAILED: \"Action could not be performed.\",\r\n\t\tDONE: \"Done.\"\r\n\t};\r\n\tfunction isOpen() {\r\n\t\treturn opened;\r\n\t}\r\n\tfunction send(str, fn) {\r\n\t\tif ( isOpen() ) {\r\n\t\t\tif ( u.isFn(fn) ) {\r\n\t\t\t\tws.onmessage = fn;\r\n\t\t\t}\r\n\t\t\tws.send(str);\r\n\t\t}\r\n\t}\r\n\tfunction init(callback, callbackArgs) {\r\n\t\tlet h1, h2;\r\n\t\t\r\n\t\th1 = note.process(\"Opening WebSocket connection...\");\r\n\t\tws = new WebSocket(URL);\r\n\t\t\r\n\t\tws.onopen = function (e) {\r\n\t\t\th1.close();\r\n\t\t\tnote.success(\"WebSocket is opened.\");\r\n\t\t\tconsole.log(\"Connection open...\", e);\r\n\t\t\topened = true;\r\n\t\t\t\r\n\t\t\tif ( u.isFn(callback) ) {\r\n\t\t\t\th2 = note.process(msg.PROCESS);\r\n\t\t\t\tcallback.apply(undefined, callbackArgs);\r\n\t\t\t\th2.close();\r\n\t\t\t\tnote.info(msg.DONE);\r\n\t\t\t}\r\n\t\t};\r\n\t\tws.onmessage = function (e) {\r\n\t\t\tif ( u.isStr(e.data) ) {\r\n\t\t\t\tconsole.log(\"String message received\", e.data);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(\"Other message received\", e.data);\r\n\t\t\t}\r\n\t\t};\r\n\t\tws.onerror = function (e) {\r\n\t\t\th1.close();\r\n\t\t\tnote.error(\"WebSocket could not be opened.\");\r\n\t\t\tconsole.log(\"WebSocket Error: \" , e);\r\n\t\t};\r\n\t\tws.onclose = function (e) {\r\n\t\t\topened = false;\r\n\t\t\tconsole.log(\"Connection closed\", e);\r\n\t\t};\r\n\t\r\n\t}\r\n\t\r\n\tinst.isOpen = isOpen;\r\n\tinst.send = send;\r\n\tinst.init = init;\r\n\t\r\n\twindow.mainSocket = inst;\r\n\treturn inst;\r\n});"]}