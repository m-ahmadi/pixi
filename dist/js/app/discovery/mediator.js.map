{"version":3,"sources":["../../../../src/js/app/discovery/mediator.js"],"names":["define","map","wuk","newPubSub","u","inst","extend","DISCOVERY","SNMP_CREDS","SNMP_TIMES","d","DEFAULT_START_IP","DEFAULT_END_IP","DEFAULT_IP","DEFAULT_SUBNET","DEFAULT_DISCOVERY_TIMEOUT","DEFAULT_SNMP_TIMEOUT","DEFAULT_SNMP_RETRIES","MIN_DISCOVERY_TIMEOUT","MAX_DISCOVERY_TIMEOUT","MIN_SNMP_TIMEOUT","MAX_SNMP_TIMEOUT","MIN_SNMP_RETRIES","MAX_SNMP_RETRIES","host","window","location","substrBeforeLast","isValidIp","getEls","els1","els2","els3","toSend","resetData","action","rangeType","startRange","endRange","ip","subnet","snmpCredentials","discoveryTimeout","snmpTimeout","snmpRetries","closeModal","begin","openModal","reset","closeSidebar","sb","$","is","toggle","v","rgx","ip1","test","doValidation","inputEl","el","val","res","startBtn","next","removeClass","addClass","enable","disable","discover","radio1","prop","input1","input2","table","find","slice","remove","slider1","noUiSlider","set","slider2","slider3","initSliders","create","start","connect","range","min","max","on","a","b","c","toFixed","input3","init","attr","radios","parseInt","value","first","second","type","trim","filter","focus","addnew","temp","Handlebars","templates","credrow","append","text","parent","prev","each","i","j","push","submit","get","emit","discovery"],"mappings":"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","file":"mediator.js","sourcesContent":["define([\"map/mediator\", \"core/wuk\", \"core/pubsub\", \"core/util\"], function (map, wuk, newPubSub, u) {\r\n\tlet inst = u.extend( newPubSub() );\r\n\t\r\n\tconst DISCOVERY = \"#modal_discovery\";\r\n\tconst SNMP_CREDS = \"#modal_snmpcreds\";\r\n\tconst SNMP_TIMES = \"#modal_snmptimes\";\r\n\tconst d = {\r\n\t\tDEFAULT_START_IP: \"192.168.1.1\",\r\n\t\tDEFAULT_END_IP: \"192.168.1.255\",\r\n\t\tDEFAULT_IP:  \"192.168.1.1\",\r\n\t\tDEFAULT_SUBNET: \"255.255.255.0\",\r\n\t\tDEFAULT_DISCOVERY_TIMEOUT: 180,\r\n\t\tDEFAULT_SNMP_TIMEOUT: 5,\r\n\t\tDEFAULT_SNMP_RETRIES: 3,\r\n\t\tMIN_DISCOVERY_TIMEOUT: 10,\r\n\t\tMAX_DISCOVERY_TIMEOUT: 600,\r\n\t\tMIN_SNMP_TIMEOUT: 1,\r\n\t\tMAX_SNMP_TIMEOUT: 10,\r\n\t\tMIN_SNMP_RETRIES: 1,\r\n\t\tMAX_SNMP_RETRIES: 10\r\n\t};\r\n\tlet host = window.location.host;\r\n\tlet substrBeforeLast = u.substrBeforeLast;\r\n\tif ( isValidIp(host) ) {\r\n\t\td.DEFAULT_START_IP = substrBeforeLast(\".\", host) + \".1\"; \r\n\t\td.DEFAULT_END_IP = substrBeforeLast(\".\", host) + \".255\";\r\n\t\td.DEFAULT_IP = d.DEFAULT_START_IP;\r\n\t}\r\n\tconst getEls = u.getEls;\r\n\t\r\n\tlet els1, els2, els3;\r\n\tlet toSend;\r\n\t\r\n\tresetData();\r\n\tfunction resetData() {\r\n\t\ttoSend = {\r\n\t\t\taction: \"discovery\",\r\n\t\t\trangeType: 0,\r\n\t\t\tstartRange: d.DEFAULT_START_IP,\r\n\t\t\tendRange: d.DEFAULT_END_IP,\r\n\t\t\tip: \"\",\r\n\t\t\tsubnet: \"\",\r\n\t\t\tsnmpCredentials: [],\r\n\t\t\tdiscoveryTimeout: d.DEFAULT_DISCOVERY_TIMEOUT,\r\n\t\t\tsnmpTimeout: d.DEFAULT_SNMP_TIMEOUT,\r\n\t\t\tsnmpRetries: d.DEFAULT_SNMP_RETRIES\r\n\t\t};\r\n\t}\r\n\tfunction closeModal() {\r\n\t\twuk.closeModal(DISCOVERY);\r\n\t}\r\n\tfunction begin() {\r\n\t\twuk.openModal(DISCOVERY);\r\n\t\treset();\r\n\t}\r\n\tfunction closeSidebar() {\r\n\t\tlet sb = $(\"#newSide\")\r\n\t\tif ( sb.is(\":visible\") ) {\r\n\t\t\tsb.toggle(\"slide\");\r\n\t\t}\r\n\t}\r\n\tfunction isValidIp(v) {\r\n\t\tvar rgx = {\r\n\t\t\tip: /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/, // regex cookbook\r\n\t\t\tip1: /^(([1-9]?\\d|1\\d\\d|2[0-5][0-5]|2[0-4]\\d)\\.){3}([1-9]?\\d|1\\d\\d|2[0-5][0-5]|2[0-4]\\d)$/         // stackoverflow\r\n\t\t};\r\n\t\t\r\n\t\treturn rgx.ip.test(v);\r\n\t}\r\n\tfunction doValidation(inputEl) {\r\n\t\tlet el = inputEl;\r\n\t\tlet val = el.val();\r\n\t\tlet res = false;\r\n\t\tlet startBtn = els1.next;\r\n\t\t\r\n\t\tres = isValidIp(val);\r\n\t\t\r\n\t\tinputEl.removeClass(\"uk-form-success uk-form-danger\");\r\n\t\tif (res) {\r\n\t\t\tel.addClass(\"uk-form-success\");\r\n\t\t\twuk.enable( startBtn );\r\n\t\t} else {\r\n\t\t\tel.addClass(\"uk-form-danger\");\r\n\t\t\twuk.disable( startBtn );\r\n\t\t}\r\n\t}\r\n\tfunction discover() {\r\n\t\t// discover( first, second, parseInt(type, 10) );\r\n\t}\r\n\t\r\n\tfunction reset() {\r\n\t\tresetData();\r\n\t\tels1.radio1.prop(\"checked\", true);\r\n\t\tels1.input1.val( d.DEFAULT_START_IP );\r\n\t\tels1.input2.val( d.DEFAULT_END_IP );\r\n\t\tels2.table.find(\"tr\").slice(2).remove();\r\n\t\tels3.slider1[0].noUiSlider.set( d.DEFAULT_DISCOVERY_TIMEOUT );\r\n\t\tels3.slider2[0].noUiSlider.set( d.DEFAULT_SNMP_TIMEOUT );\r\n\t\tels3.slider3[0].noUiSlider.set( d.DEFAULT_SNMP_RETRIES );\r\n\t}\r\n\tfunction initSliders() {\r\n\t\tnoUiSlider.create(els3.slider1[0], {\r\n\t\t\tstart: d.DEFAULT_DISCOVERY_TIMEOUT,\r\n\t\t\tconnect: [true, false],\r\n\t\t\trange: {\r\n\t\t\t\tmin: d.MIN_DISCOVERY_TIMEOUT,\r\n\t\t\t\tmax: d.MAX_DISCOVERY_TIMEOUT\r\n\t\t\t}\r\n\t\t});\r\n\t\tnoUiSlider.create(els3.slider2[0], {\r\n\t\t\tstart: d.DEFAULT_SNMP_TIMEOUT,\r\n\t\t\tconnect: [true, false],\r\n\t\t\trange: {\r\n\t\t\t\tmin: d.MIN_SNMP_TIMEOUT,\r\n\t\t\t\tmax: d.MAX_SNMP_TIMEOUT\r\n\t\t\t}\r\n\t\t});\r\n\t\tnoUiSlider.create(els3.slider3[0], {\r\n\t\t\tstart: d.DEFAULT_SNMP_RETRIES,\r\n\t\t\tconnect: [true, false],\r\n\t\t\trange: {\r\n\t\t\t\tmin: d.MIN_SNMP_RETRIES,\r\n\t\t\t\tmax: d.MAX_SNMP_RETRIES\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\tels3.slider1[0].noUiSlider.on(\"update\", function (a, b, c) {\r\n\t\t\tels3.input1.val( c[0].toFixed() );\r\n\t\t});\r\n\t\tels3.slider2[0].noUiSlider.on(\"update\", function (a, b, c) {\r\n\t\t\tels3.input2.val( c[0].toFixed() );\r\n\t\t});\r\n\t\tels3.slider3[0].noUiSlider.on(\"update\", function (a, b, c) {\r\n\t\t\tels3.input3.val( c[0].toFixed() );\r\n\t\t});\r\n\t}\r\n\tfunction init() {\r\n\t\tels1 = getEls(DISCOVERY);\r\n\t\tels2 = getEls(SNMP_CREDS);\r\n\t\tels3 = getEls(SNMP_TIMES);\r\n\t\t\r\n\t\tels1.radio1.prop(\"checked\", true);\r\n\t\tels1.input1.attr(\"value\", d.DEFAULT_START_IP);\r\n\t\tels1.input2.attr(\"value\", d.DEFAULT_END_IP);\r\n\t\tdoValidation(els1.input1);\r\n\t\tdoValidation(els1.input2);\r\n\t\t\r\n\t\tels1.radios.on(\"click\", function () {\r\n\t\t\tlet rangeType = parseInt(this.value, 10),\r\n\t\t\t\tfirst, second;\r\n\t\t\t\t\r\n\t\t\tfirst = els1.input1;\r\n\t\t\tsecond = els1.input2;\r\n\t\t\t\r\n\t\t\tif (rangeType === 0) {\r\n\t\t\t\tfirst.val( d.DEFAULT_START_IP );\r\n\t\t\t\tsecond.val( d.DEFAULT_END_IP );\r\n\t\t\t} else {\r\n\t\t\t\tfirst.val( d.DEFAULT_IP );\r\n\t\t\t\tsecond.val( d.DEFAULT_SUBNET );\r\n\t\t\t}\r\n\t\t\tdoValidation( els1.input1 );\r\n\t\t\tdoValidation( els1.input2 );\r\n\t\t});\r\n\t\tels1.input1.on(\"keyup\", function () {\r\n\t\t\tdoValidation( $(this) );\r\n\t\t});\r\n\t\tels1.input2.on(\"keyup\", function () {\r\n\t\t\tdoValidation( $(this) );\r\n\t\t});\r\n\t\tels1.next.on(\"click\", function () {\r\n\t\t\tlet first, second, type;\r\n\t\t\t\r\n\t\t\tfirst = els1.input1.val();\r\n\t\t\tsecond = els1.input2.val();\r\n\t\t\t\r\n\t\t\tfirst = first ? first.trim() : \"\";\r\n\t\t\tsecond = second ? second.trim() : \"\";\r\n\t\t\t\r\n\t\t\ttype = els1.radios.filter(\":checked\").val();\r\n\t\t\ttype = parseInt(type, 10);\r\n\t\t\t\r\n\t\t\ttoSend.rangeType  = type;\r\n\t\t\ttoSend.startRange = type === 0 ? first  : \"\";\r\n\t\t\ttoSend.endRange   = type === 0 ? second : \"\";\r\n\t\t\ttoSend.ip         = type === 1 ? first  : \"\";\r\n\t\t\ttoSend.subnet     = type === 1 ? second : \"\";\r\n\t\t\t\r\n\t\t\twuk.openModal(SNMP_CREDS);\r\n\t\t\tels2.table.find(\"[data-input]:last\").focus();\r\n\t\t});\r\n\t\tels2.addnew.on(\"click\", function () {\r\n\t\t\tlet temp = Handlebars.templates.credrow;\r\n\t\t\tels2.table.append( temp({text:\"\"}) );\r\n\t\t\tels2.table.find(\"[data-input]\").focus();\r\n\t\t});\r\n\t\tels2.table.on(\"click\", \"button[data-delete]\", function () {\r\n\t\t\tlet el = $(this);\r\n\t\t\tel.parent().parent().remove();\r\n\t\t\tels2.table.find(\"[data-input]:last\").focus();\r\n\t\t});\r\n\t\tels2.prev.on(\"click\", function () {\r\n\t\t\ttoSend.snmpCredentials = [];\r\n\t\t\twuk.openModal(DISCOVERY);\r\n\t\t});\r\n\t\tels2.next.on(\"click\", function () {\r\n\t\t\ttoSend.snmpCredentials = [];\r\n\t\t\tels2.table.find(\"[data-input]\").each((i, j) => {\r\n\t\t\t\ttoSend.snmpCredentials.push( $(j).val() );\r\n\t\t\t});\r\n\t\t\twuk.openModal(SNMP_TIMES);\r\n\t\t});\r\n\t\tels3.prev.on(\"click\", function () {\r\n\t\t\twuk.openModal(SNMP_CREDS);\r\n\t\t});\r\n\t\tels3.submit.on(\"click\", function () {\r\n\t\t\ttoSend.discoveryTimeout = parseInt( els3.slider1[0].noUiSlider.get(), 10 ).toFixed();\r\n\t\t\ttoSend.snmpTimeout      = parseInt( els3.slider2[0].noUiSlider.get(), 10 ).toFixed();\r\n\t\t\ttoSend.snmpRetries      = parseInt( els3.slider3[0].noUiSlider.get(), 10 ).toFixed();\r\n\t\t\t\r\n\t\t\tinst.emit(\"submit\", toSend);\r\n\t\t\twuk.closeModal(SNMP_TIMES);\r\n\t\t\treset();\r\n\t\t});\r\n\t\t\r\n\t\tinitSliders();\r\n\t}\r\n\t\r\n\tinst.isValidIp = isValidIp;\r\n\tinst.begin = begin;\r\n\tinst.init = init;\r\n\t\r\n\twindow.discovery = inst;\r\n\treturn inst;\r\n});"]}