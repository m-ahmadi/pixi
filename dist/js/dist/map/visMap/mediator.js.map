{"version":3,"sources":["../../../../../src/js/app/map/visMap/mediator.js"],"names":["define","conf","u","whb","inst","g","tmpl","ROOT","WORKERS_DIR","network","options","container","nodes","vis","DataSet","edges","nodeTypes","dataConvertor","autoResize","height","width","locale","clickToUse","configure","enabled","smooth","type","arrows","to","scaleFactor","arrowStrikethrough","borderWidth","shape","color","size","font","face","groups","type1","type2","type3","type4","type5","type6","type7","type8","type9","layout","improvedLayout","interaction","hideEdgesOnDrag","hover","tooltipDelay","physics","t0","t1","createWorker","window","Worker","highlighter","onmessage","e","console","log","data","update","performance","now","length","warn","convertData","oldNodes","oldLinks","links","newData","newNodes","newEdges","Object","keys","forEach","k","node","add","id","label","name","management_ip","group","x","y","title","nodepopup","link","src","dest","isObj","source_id","destination_id","draw","postMessage","init","elementId","innerWidth","innerHeight","hW","hH","$","Network","on","workerHighlight","GRAYED_OUT_COLOR","active","highlightActive","neighbourhoodHighlight","i","edge","hiddenLabel","len","originalColor","targetId","connectedNodes","connectedEdges","o","returnType","toUpdateNodes","toUpdateEdges","get","undefined","getConnectedNodes","getConnectedEdges","push","clear","visMap"],"mappings":"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","file":"mediator.js","sourcesContent":["define([\"config\", \"core/util\", \"core/whb\"], function (conf, u, whb) {\r\n\tvar inst = {},\r\n\t\tg = {},\r\n\t\ttmpl = whb.tmpl;\r\n\t\r\n\tconst ROOT = conf.ROOT;\r\n\t\r\n\tg.WORKERS_DIR = `${ROOT}js/dist/workers`;\r\n\tg.network = {};\r\n\tg.options = {};\r\n\tg.container = {};\r\n\tg.nodes = new vis.DataSet();\r\n\tg.edges = new vis.DataSet();\r\n\tg.nodeTypes = [\"type1\", \"type2\", \"type3\", \"type4\", \"type5\", \"type6\", \"type7\", \"type8\", \"type9\",];\r\n\tg.dataConvertor = {};\r\n\t\r\n\tg.options = {\r\n\t\tautoResize: true,\r\n\t\theight: \"100%\",\r\n\t\twidth: \"100%\",\r\n\t\tlocale: \"en\",\r\n\t//\tlocales: locales,\r\n\t\tclickToUse: false,\r\n\t\tconfigure: {\r\n\t\t\tenabled: false\r\n\t\t},\r\n\t\tedges: {\r\n\t\t\twidth: 1,\r\n\t\t\tsmooth: {\r\n\t\t\t\ttype: \"continuous\" // \"dynamic\", \"continuous\", \"discrete\", \"diagonalCross\", \"straightCross\", \"horizontal\", \"vertical\", \"curvedCW\", \"curvedCCW\", \"cubicBezier\"\r\n\t\t\t},\r\n\t\t\tarrows: {\r\n\t\t\t\tto: {\r\n\t\t\t\t\tenabled: true,\r\n\t\t\t\t\tscaleFactor: 0.6,\r\n\t\t\t\t\ttype: \"arrow\"\r\n\t\t\t\t},\r\n\t\t\t\t\"from\": {\r\n\t\t\t\t\tenabled: true,\r\n\t\t\t\t\tscaleFactor: 0.2,\r\n\t\t\t\t\ttype: \"circle\"\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\tarrowStrikethrough: true // default true\r\n\t\t},\r\n\t\tnodes: {\r\n\t\t\tborderWidth: 1,\r\n\t\t\tshape: \"dot\",\r\n\t\t\tcolor: \"#4CAF50\",\r\n\t\t\tsize: 10,\r\n\t\t\tfont: {\r\n\t\t\t\tsize: 12,\r\n\t\t\t\tface: \"Tahoma\"\r\n\t\t\t}\r\n\t\t},\r\n\t\tgroups: {\r\n\t\t\t/* type1: {\r\n\t\t\t\tshape: \"icon\",\r\n\t\t\t\ticon: {\r\n\t\t\t\t\tface: \"FontAwesome\",\r\n\t\t\t\t\tcode: \"\\uf0c0\", // group\r\n\t\t\t\t\tsize: 50,\r\n\t\t\t\t\tcolor: \"#57169a\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttype2: {\r\n\t\t\t\tshape: \"icon\",\r\n\t\t\t\ticon: {\r\n\t\t\t\t\tface: \"FontAwesome\",\r\n\t\t\t\t\tcode: \"\\uf007\", // users\r\n\t\t\t\t\tsize: 50,\r\n\t\t\t\t\tcolor: \"#3f51b5\"\r\n\t\t\t\t}\r\n\t\t\t}, */\r\n\t\t\ttype1: {\r\n\t\t\t\tshape: \"dot\",\r\n\t\t\t\tcolor: \"red\"\r\n\t\t\t},\r\n\t\t\ttype2: {\r\n\t\t\t\tshape: \"dot\",\r\n\t\t\t\tcolor: \"blue\"\r\n\t\t\t},\r\n\t\t\ttype3: {\r\n\t\t\t\tshape: \"dot\",\r\n\t\t\t\tcolor: \"#e91e63\"\r\n\t\t\t},\r\n\t\t\ttype4: {\r\n\t\t\t\tshape: \"diamond\",\r\n\t\t\t\tcolor: \"#fb7e81\"\r\n\t\t\t},\r\n\t\t\ttype5: {\r\n\t\t\t\tshape: \"star\",\r\n\t\t\t\tcolor: \"#FFEB3B\"\r\n\t\t\t},\r\n\t\t\ttype6: {\r\n\t\t\t\tshape: \"triangle\",\r\n\t\t\t\tcolor: \"#ffff00\"\r\n\t\t\t},\r\n\t\t\ttype7: {\r\n\t\t\t\tshape: \"dot\",\r\n\t\t\t\tcolor: \"#33691e\"\r\n\t\t\t},\r\n\t\t\ttype8: {\r\n\t\t\t\tshape: \"square\",\r\n\t\t\t\tcolor: \"#ffd600\"\r\n\t\t\t},\r\n\t\t\ttype9: {\r\n\t\t\t\tshape: \"triangleDown\",\r\n\t\t\t\tcolor: \"#ff1744\"\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\tlayout: {\r\n\t\t\timprovedLayout: false\r\n\t\t},\r\n\t\tinteraction: {\r\n\t\t\thideEdgesOnDrag: true,\r\n\t\t\thover: true,\r\n\t\t\ttooltipDelay: 200\r\n\t\t},\r\n\t//\tmanipulation: {},\r\n\t\tphysics: false // true false\r\n\t};\r\n\t\r\n\tvar t0, t1;\r\n\t\r\n\tfunction createWorker() {\r\n\t\tif (window.Worker) {\r\n\t\t\tg.dataConvertor = new Worker(`${g.WORKERS_DIR}/dataConvertor.js`);\r\n\t\t\tg.highlighter = new Worker(`${g.WORKERS_DIR}/highlighter.js`);\r\n\t\t\t\r\n\t\t\tg.dataConvertor.onmessage = function (e) {\r\n\t\t\t\tconsole.log(\"convert is finished.\");\r\n\t\t\t\tvar data = e.data;\r\n\t\t\t\tg.nodes.update(data.nodes);\r\n\t\t\t\tg.edges.update(data.edges);\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tg.highlighter.onmessage = function (e) {\r\n\t\t\t\tt1 = performance.now();\r\n\t\t\t\tconsole.log(\"worker is finished: \"+ (t1-t0) );\r\n\t\t\t\tvar data = e.data,\r\n\t\t\t\t\tnodes = data.nodes,\r\n\t\t\t\t\tedges = data.edges\r\n\t\t\t\t\r\n\t\t\t\tif (nodes.length) {\r\n\t\t\t\t\tg.nodes.update(data.nodes);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (edges.length) {\r\n\t\t\t\t\tg.edges.update(data.edges);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tconsole.warn(\"Your browser doesn't support web workers.\");\r\n\t\t}\r\n\t}\r\n\tfunction convertData(data) {\r\n\t\tvar oldNodes = data.nodes,\r\n\t\t\toldLinks = data.links,\r\n\t\t\tnewData = {},\r\n\t\t\tnewNodes = [],\r\n\t\t\tnewEdges = [];\r\n\t\t\r\n\t\tObject.keys(oldNodes).forEach(function (k) {\r\n\t\t\tvar node = oldNodes[k];\r\n\t\t\t\r\n\t\t\tg.nodes.add({\r\n\t\t\t\tid: node.id,\r\n\t\t\t\tlabel: node.name || node.management_ip,\r\n\t\t\t\tgroup: g.nodeTypes[node.type],\r\n\t\t\t\tx: node.x,\r\n\t\t\t\ty: node.y,\r\n\t\t\t\ttitle: tmpl.nodepopup({name: node.name, id: node.id})\r\n\t\t\t});\r\n\t\t\t\r\n\t\t});\r\n\t\tObject.keys(oldLinks).forEach(function (k) {\r\n\t\t\tvar link = oldLinks[k],\r\n\t\t\t\tsrc = link.src,\r\n\t\t\t\tdest = link.dest;\r\n\t\t\t\r\n\t\t\tg.edges.add({\r\n\t\t\t\t/* from: link.src.id,\r\n\t\t\t\tto: link.dest.id */\r\n\t\t\t\t\r\n\t\t\t\t\"from\": u.isObj(src) ? src.id : src || link.source_id,\r\n\t\t\t\tto: u.isObj(dest) ? dest.id : dest || link.destination_id,\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t\tnewData.nodes = newNodes;\r\n\t\tnewData.edges = newEdges;\r\n\t\treturn newData;\r\n\t}\r\n\tfunction draw(data) {\r\n\t\t// data = convertData(data);\r\n\t\tdata.nodeTypes = g.nodeTypes;\r\n\t\tg.dataConvertor.postMessage(data);\r\n\t\t\r\n\t\t// g.nodes.update(data.nodes);\r\n\t\t// g.edges.update(data.edges);\r\n\t\t\r\n\t\t// g.network.setData({nodes: data.nodes, edges: data.edges});\r\n\t}\r\n\tfunction init(elementId) {\r\n\t\tvar width = window.innerWidth,\r\n\t\t\theight = window.innerHeight,\r\n\t\t\thW = width / 2;\r\n\t\t\thH = height / 2;\r\n\t\t\r\n\t\tg.container = $(elementId);\r\n\t\tg.container.height(window.innerHeight);\r\n\t\t\r\n\t\tg.network = new vis.Network(g.container[0], {nodes: g.nodes, edges: g.edges}, g.options);\r\n\t\tg.network.on(\"click\", workerHighlight); // workerHighlight neighbourhoodHighlight\r\n\t\twindow.network = g.network;\r\n\t\t\r\n\t\t$(window).on(\"resize\", function () {\r\n\t\t\tg.container.height(window.innerHeight);\r\n\t\t});\r\n\t\t/* $.ajax({\r\n\t\t\turl: \"http://localhost:3000\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdataType: \"json\",\r\n\t\t\tdata: {\r\n\t\t\t\tx1: -hW,// hW\r\n\t\t\t\tx2: hW,// hW window.innerWidth,\r\n\t\t\t\ty1: -hH, // hH\r\n\t\t\t\ty2: hH // hH window.innerHeight\r\n\t\t\t}\r\n\t\t})\r\n\t\t.done(function (data) {\r\n\t\t\tconsole.log(data);\r\n\t\t\tt = data;\r\n\t\t\tdraw(data);\r\n\t\t}); */\r\n\t\tcreateWorker();\r\n\t}\r\n\t\r\n\t\r\n\tvar GRAYED_OUT_COLOR = \"rgba(200, 200, 200, 0.5)\"; \"rgba(150, 150, 150, 0.75)\"\r\n\tvar active = false;\r\n\t\r\n\t\r\n\t\r\n\t\r\n\tvar highlightActive = false;\r\n\tfunction neighbourhoodHighlight(e) {\r\n\t\tvar t0 = performance.now();\r\n\t\t\r\n\t\tvar network,\r\n\t\t\tnodes,\r\n\t\t\tedges,\r\n\t\t\tk, i, node, edge, hiddenLabel, len, originalColor,\r\n\t\t\tkeys,\r\n\t\t\ttargetId,\r\n\t\t\tconnectedNodes, connectedEdges,\r\n\t\t\to = {returnType: \"Object\"},\r\n\t\t\ttoUpdateNodes = [],\r\n\t\t\ttoUpdateEdges = [];\r\n\t\t\t\r\n\t\t\r\n\t\tnodes = g.nodes.get(o);\r\n\t\tedges = g.edges.get(o);\r\n\t\t\r\n\t\tif (e.nodes.length > 0) {\r\n\t\t\tnetwork = g.network;\r\n\t\t\thighlightActive = true;\r\n\t\t\ttargetId = e.nodes[0];\r\n\t\t\t\r\n\t\t\tkeys = Object.keys(nodes);\r\n\t\t\tlen = keys.length;\r\n\t\t\tfor (i=0; i<len; i+=1) {\r\n\t\t\t\tnode = nodes[ keys[i] ];\r\n\t\t\t\thiddenLabel = node.hiddenLabel;\r\n\t\t\t\t\r\n\t\t\t\tnode.color = GRAYED_OUT_COLOR;\r\n\t\t\t\tif (hiddenLabel === undefined) {\r\n\t\t\t\t\tnode.hiddenLabel = node.label;\r\n\t\t\t\t\tnode.label = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconnectedNodes = network.getConnectedNodes(targetId); // array of ids\r\n\t\t\tlen = connectedNodes.length;\r\n\t\t\t\r\n\t\t\tfor (i=0; i<len; i+=1) {\r\n\t\t\t\tnode = nodes[ connectedNodes[i] ];\r\n\t\t\t\thiddenLabel = node.hiddenLabel;\r\n\t\t\t\t\r\n\t\t\t\tnode.color = undefined;\r\n\t\t\t\tif (hiddenLabel !== undefined) {\r\n\t\t\t\t\tnode.label = hiddenLabel;\r\n\t\t\t\t\tnode.hiddenLabel = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tnode = nodes[targetId];\r\n\t\t\thiddenLabel = node.hiddenLabel;\r\n\t\t\tnode.color = undefined;\r\n\t\t\tif (hiddenLabel !== undefined) {\r\n\t\t\t\tnode.label = hiddenLabel;\r\n\t\t\t\tnode.hiddenLabel = undefined;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tkeys = Object.keys(edges);\r\n\t\t\tlen = keys.length;\r\n\t\t\tfor (i=0; i<len; i+=1) {\r\n\t\t\t\tedge = edges[ keys[i] ];\r\n\t\t\t\toriginalColor = edge.originalColor;\r\n\t\t\t\tif (originalColor === undefined) {\r\n\t\t\t\t\tedge.originalColor = edge.color;\r\n\t\t\t\t\tedge.color = GRAYED_OUT_COLOR;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconnectedEdges = network.getConnectedEdges(targetId); // array of ids\r\n\t\t\t\r\n\t\t\tlen = connectedEdges.length;\r\n\t\t\tfor (i=0; i<len; i+=1) {\r\n\t\t\t\tedge = edges[ connectedEdges[i] ];\r\n\t\t\t\toriginalColor = edge.originalColor;\r\n\t\t\t\tif (originalColor !== undefined) {\r\n\t\t\t\t\tedge.color = originalColor;\r\n\t\t\t\t\tedge.originalColor = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t} else if (highlightActive === true) {\r\n\t\t\tkeys = Object.keys(nodes);\r\n\t\t\tlen = keys.length;\r\n\t\t\tfor (i=0; i<len; i+=1) {\r\n\t\t\t\tnode = nodes[ keys[i] ];\r\n\t\t\t\thiddenLabel = node.hiddenLabel;\r\n\t\t\t\t\r\n\t\t\t\tnode.color = undefined;\r\n\t\t\t\tif (hiddenLabel !== undefined) {\r\n\t\t\t\t\tnode.label = hiddenLabel;\r\n\t\t\t\t\tnode.hiddenLabel = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tkeys = Object.keys(edges);\r\n\t\t\tlen = keys.length;\r\n\t\t\tfor (i=0; i<len; i+=1) {\r\n\t\t\t\tedge = edges[ keys[i] ];\r\n\t\t\t\toriginalColor = edge.originalColor;\r\n\t\t\t\tif (originalColor !== undefined) {\r\n\t\t\t\t\tedge.color = originalColor;\r\n\t\t\t\t\tedge.originalColor = undefined;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\thighlightActive = false\r\n\t\t}\r\n\t\t\r\n\t\tkeys = Object.keys(nodes);\r\n\t\tlen = keys.length;\r\n\t\tfor (i=0; i<len; i+=1) {\r\n\t\t\ttoUpdateNodes.push( nodes[ keys[i] ] );\r\n\t\t}\r\n\t\t\r\n\t\tkeys = Object.keys(edges);\r\n\t\tlen = keys.length;\r\n\t\tfor (i=0; i<len; i+=1) {\r\n\t\t\ttoUpdateEdges.push( edges[ keys[i] ] );\r\n\t\t}\r\n\t\t\r\n\t\tvar t1 = performance.now();\r\n\t\tconsole.log(\"took \" + (t1 - t0) + \" milliseconds.\");\r\n\t\t\r\n\t\tg.nodes.update(toUpdateNodes);\r\n\t\tg.edges.update(toUpdateEdges);\r\n\t}\r\n\t\r\n\tvar highlightActive = false;\r\n\tfunction workerHighlight(e) {\r\n\t\t\r\n\t\tvar targetId = e.nodes[0];\r\n\t\tvar network = g.network;\r\n\t\tvar o = {returnType: \"Object\"};\r\n\t\tvar data = {\r\n\t\t\tlen: e.nodes.length,\r\n\t\t\ttargetId: targetId,\r\n\t\t\tnodes: g.nodes.get(o),\r\n\t\t\tedges: g.edges.get(o),\r\n\t\t\tconnectedNodes: targetId ? network.getConnectedNodes(targetId) : [],\r\n\t\t\tconnectedEdges: targetId ? network.getConnectedEdges(targetId) : []\r\n\t\t};\r\n\t\t\r\n\t\tt0 = performance.now();\r\n\t\tg.highlighter.postMessage(data);\r\n\t}\r\n\t\r\n\t\r\n\t\r\n\t\r\n\tinst.convertData = convertData;\r\n\tinst.draw = draw;\r\n\tinst.init = init;\r\n\tinst.clear = function () {\r\n\t\tg.nodes.clear();\r\n\t\tg.edges.clear();\r\n\t};\r\n\tinst.g = g;\r\n\t\r\n\twindow.visMap = g;\r\n\treturn inst;\r\n});"]}