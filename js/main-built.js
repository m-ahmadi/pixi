var util=function(){function e(e){return!(!e||"object"!=typeof e||null===typeof e||"[object Object]"!==Object.prototype.toString.call(e))}function n(e){return"function"==typeof Array.isArray?Array.isArray(e):!(!e||"object"!=typeof e||"number"!=typeof e.length||"function"!=typeof e.splice||e.propertyIsEnumerable("length")||"[object Array]"!==Object.prototype.toString.call(e))}function t(e){var n,t=new Array(e.length);for(n=0;n<t.length;n+=1)t[n]=e[n];return t}function o(e,n,t){e.splice(t,0,e.splice(n,1)[0])}function i(e){return h(e)&&e%1===0}function r(e){return h(e)?Math.abs(e)*-1:void 0}function a(e){return h(e)?Math.abs(e):void 0}function c(e){if(h(e)){if(e>0)return r(e);if(e<0)return a(e)}}function s(e){return!!(h(e)&&e%2)}function d(e,n){return e=e?Math.ceil(e):0,n=n?Math.floor(n):2,Math.floor(Math.random()*(n-e))+e}function u(e,n){return e=e?e:0,n=n?n:1,Math.random()*(n-e)+e}function f(e,n){return h(e)?parseFloat(e.toFixed(n)):void 0}function l(n){var t;if(e(n)){if("function"==typeof Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(n).length;for(t in n)if(n.hasOwnProperty(t))return!1;return!0}}function p(e){return"function"==typeof e}function g(e){return"string"==typeof e}function h(e){return"number"==typeof e}function v(e){return"boolean"==typeof e}function m(e){return"undefined"==typeof e}function y(e){return"string"==typeof e&&0===e.length}function w(n){if(e(n))return Object.keys(n).length}function b(){var t,o,i,r=Array.prototype.slice.call(arguments),a=r.length,c=[],s=[];return 1===a?(t=r[0],n(t)&&t.length>1?(o=t.pop(),s=t):e(t)&&(i=Object.create(t))):2===a?(t=r[0],o=r[a-1],e(t)&&(i=Object.create(t))):a>2&&(o=r.pop(),s=r),0!==s.length&&(c.push({}),s.forEach(function(n,t){e(n)&&(Object.keys(n).forEach(function(e){c[t][e]=n[e]}),c.push(Object.create(c[t])))}),i=c[c.length-1]),o&&e(o)&&Object.keys(o).forEach(function(e){i[e]=o[e]}),i}function k(e){return $(e).contents().filter(function(){return 8===this.nodeType})}function O(e){return k(e)[0].nodeValue.trim()}return"function"!=typeof Object.create&&(Object.create=function(e){function n(){}return n.prototype=e,new n}),"function"!=typeof Object.keys&&(Object.keys=function(e){var n,t=[];for(n in e)e.hasOwnProperty(n)&&t.push(n);return t}),Object.defineProperty(Array.prototype,"myForEach",{enumerable:!1,configurable:!1,value:function(e){var n,t=this,o=t.length;for(n=0;n<o;n+=1)e(t[n],n,t)}}),{isObj:e,isArr:n,getArgs:t,moveArrItem:o,isInt:i,negateNum:r,positNum:a,reverseNumSign:c,isNumOdd:s,randInt:d,randFloat:u,toDecimalPlace:f,isEmptyObj:l,isFn:p,isStr:g,isNum:h,isBool:v,isUndef:m,isEmptyStr:y,objLength:w,extend:b,getCommentsInside:k,getFirstCommentInside:O}}();"function"==typeof define&&define.amd?define("core/util",util):"undefined"!=typeof module&&(module.exports=util),define("core/ajax",[],function(){function e(){return"a"+(r+=1)}function n(e,n,t,o,r){var a=i[e],c=a[n];"function"==typeof c&&c(t,o,r)}function t(i){i=i?i:{};var r=e();return t.id=r,o=$.ajax({url:i.url||"http://localhost:3000",type:i.type||"GET",dataType:i.dataType||"json",data:i.data,beforeSend:i.beforeSend,id:r}).done(function(e,o,i){this.id===t.id&&n("done",r,e,o,i)}).fail(function(e,t,o){n("fail",r,e,t,o)}).always(function(e,t){n("always",r,e,t)}),t.xhr=o,t}$.support.cors=!0,$.ajaxSetup({crossDomain:!0});var o,i={},r=0;return i.done={},i.fail={},i.always={},t.done=function(e){return i.done[this.id]=e,this},t.fail=function(e){return i.fail[this.id]=e,this},t.always=function(e){return i.always[this.id]=e,this},t.callbacks=i,t}),define("core/whb",["./util"],function(e){function n(){$("#templates > *").each(function(e,n){var t=n.id,r=t.split("_")[0],a=i("#"+t);o[r]=Handlebars.compile(a)})}var t={},o={},i=e.getFirstCommentInside;return Object.defineProperties(t,{tmpl:{get:function(){return o}}}),t.compileAll=n,window.whb=t,t}),define("map/visMap/mediator",["core/util","core/ajax","core/whb"],function(e,n,o){function i(){window.Worker?(u.dataConvertor=new Worker("js/workers/dataConvertor.js"),u.highlighter=new Worker("js/workers/highlighter.js"),u.dataConvertor.onmessage=function(e){console.log("convert is finished.");var n=e.data;u.nodes.update(n.nodes),u.edges.update(n.edges)},u.highlighter.onmessage=function(e){p=performance.now(),console.log("worker is finished: "+(p-l));var n=e.data,t=n.nodes,o=n.edges;t.length&&u.nodes.update(n.nodes),o.length&&u.edges.update(n.edges)}):console.warn("Your browser doesn't support web workers.")}function r(n){var t=n.nodes,o=n.links,i={},r=[],a=[];return Object.keys(t).forEach(function(e){var n=t[e];u.nodes.add({id:n.id,label:n.name||n.management_ip,group:u.nodeTypes[n.type],x:n.x,y:n.y,title:f.nodepopup({name:n.name,id:n.id})})}),Object.keys(o).forEach(function(n){var t=o[n],i=t.src,r=t.dest;u.edges.add({from:e.isObj(i)?i.id:i||t.source_id,to:e.isObj(r)?r.id:r||t.destination_id})}),i.nodes=r,i.edges=a,i}function a(e){e.nodeTypes=u.nodeTypes,u.dataConvertor.postMessage(e)}function c(e){var o=(window.innerWidth,window.innerHeight);hH=o/2,u.container=$(e),u.container.height(window.innerHeight),u.network=new vis.Network(u.container[0],{nodes:u.nodes,edges:u.edges},u.options),u.network.on("click",s),window.network=u.network,n({data:{x1:-3e3,x2:3e3,y1:-500,y2:500}}).done(function(e){console.log(e),t=e,a(e)}),i()}function s(e){var n=e.nodes[0],t=u.network,o={returnType:"Object"},i={len:e.nodes.length,targetId:n,nodes:u.nodes.get(o),edges:u.edges.get(o),connectedNodes:n?t.getConnectedNodes(n):[],connectedEdges:n?t.getConnectedEdges(n):[]};l=performance.now(),u.highlighter.postMessage(i)}var d={},u={},f=o.tmpl;u.network={},u.options={},u.container={},u.nodes=new vis.DataSet,u.edges=new vis.DataSet,u.nodeTypes=["type1","type2","type3","type4","type5","type6","type7","type8","type9"],u.dataConvertor={},u.options={autoResize:!0,height:"100%",width:"100%",locale:"en",clickToUse:!1,configure:{enabled:!1},edges:{width:1,smooth:{type:"continuous"},arrows:{to:{enabled:!0,scaleFactor:.6,type:"arrow"},from:{enabled:!0,scaleFactor:.2,type:"circle"}},arrowStrikethrough:!0},nodes:{borderWidth:1,shape:"dot",color:"#4CAF50",size:10,font:{size:12,face:"Tahoma"}},groups:{type1:{shape:"dot",color:"red"},type2:{shape:"dot",color:"blue"},type3:{shape:"dot",color:"#e91e63"},type4:{shape:"diamond",color:"#fb7e81"},type5:{shape:"star",color:"#FFEB3B"},type6:{shape:"triangle",color:"#ffff00"},type7:{shape:"dot",color:"#33691e"},type8:{shape:"square",color:"#ffd600"},type9:{shape:"triangleDown",color:"#ff1744"}},layout:{improvedLayout:!1},interaction:{hideEdgesOnDrag:!0,hover:!0,tooltipDelay:200},physics:!1};var l,p;return d.convertData=r,d.draw=a,d.init=c,d.clear=function(){u.nodes.clear(),u.edges.clear()},d.g=u,window.visMap=u,d}),define("map/mediator",["./visMap/mediator","core/util"],function(e,n){function t(n,t){i=n,"pixiMap"===n?r=pixiMap:"visMap"===n&&(r=e),r.init(t)}var o={},i="",r={};return Object.defineProperties(o,{width:{get:function(){return r.width}},height:{get:function(){return r.height}},resize:{get:function(){return r.resize}},setPosition:{get:function(){return r.setPosition}},clear:{get:function(){return r.clear}}}),o.draw=function(e,n,t,o,a){"pixiMap"===i?r.draw(e,n,t,o,a):"visMap"===i&&r.draw(e)},o.init=t,window.map=o,o}),define("core/wuk",["./util"],function(e){function n(e){return UIkit.modal(e)[0]}function t(e){e.is(":disabled")||e.attr("disabled","")}function o(e){e.is(":enabled")||e.removeAttr("disabled")}function i(t){e=n(t),e.isActive()&&e.hide()}function r(t){e=n(t),e.isActive()||e.show()}function a(e,n){e===!0?d[n]=!0:e||(d[n]=!1)}function c(){var e=!1;return Object.keys(d).forEach(function(n){d[n]===!0&&(e=!0)}),e}var s={},d={},u=function(){function n(e){var n;return n=UIkit.notification(e)}function t(t,o,i,r){var a,c,d,u="NO_MESSAGE_WAS_SPECIFIED";return"info"===t?(a=s.INFO,c="info"):"success"===t?(a=s.SUCCESS,c="success"):"warning"===t?(a=s.WARNING,c="warning"):"error"===t?(a=s.ERROR,c="danger"):"process"===t&&(a=s.PROCESS,c="info"),d=n({message:a+" "+(o||u),status:c,timeout:e.isNum(i)?i:1e3,pos:r||"bottom-right"})}function o(e,n,o){return t("info",e,n,o)}function i(e,n,o){return t("success",e,n,o)}function r(e,n,o){return t("warning",e,n,o)}function a(e,n,o){return t("error",e,n,o)}function c(e,n,o){return t("process",e,n,o)}var s={INFO:'<i class="fa  fa-info-circle           fa-lg"  aria-hidden="true"></i>',SUCCESS:'<i class="fa  fa-check-circle          fa-lg"  aria-hidden="true"></i> ',WARNING:'<i class="fa  fa-exclamation           fa-lg"  aria-hidden="true"></i>',ERROR:'<i class="fa  fa-exclamation-triangle  fa-lg"  aria-hidden="true"></i>',PROCESS:'<i class="fa  fa-refresh               fa-lg   fa-fw fa-spin"></i>'};return{info:o,success:i,warning:r,error:a,process:c}}();return s.note=u,s.disable=t,s.enable=o,s.closeModal=i,s.openModal=r,s.isAnyModalActive=c,s.modalState=a,window.mmm=d,window.wuk=s,s}),define("core/discovery",["map/mediator","core/wuk"],function(e,n){function t(e){var n={ip:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ip1:/^(([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)\.){3}([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)$/};return n.ip.test(e)}function o(){n.closeModal("#modal_discovery")}function i(){var e=$("#newSide");e.is(":visible")&&e.toggle("slide")}function r(n,t,r){var c={StartRange:"",EndRange:"",IP:"",Subnet:""};r?(c.IP=n,c.Subnet=t):(c.StartRange=n,c.EndRange=t),s+=r?"?type=1":"?type=0",a=new WebSocket(s),a.onopen=function(e){console.log("Connection open...",e),a.send(JSON.stringify(c))},a.onmessage=function(n){var t=n.data;o(),i(),"string"==typeof n.data?(console.log("String message received",n,n.data),t=JSON.parse(t),d={x:e.width/380,y:e.height/380},e.draw(t,"viewport",void 0,d)):console.log("Other message received",n,n.data)},a.onerror=function(e){console.log("WebSocket Error: ",e)},a.onclose=function(e){o(),i(),console.log("Connection closed",e)}}var a,c={},s="ws://"+window.location.host+"/network/discovery",d={};return c.isValidIp=t,c.discover=r,c}),define("core/traceroute",["map/mediator","core/wuk","core/util"],function(e,n,t){function o(e){var n=e.links,t=e.nodes,o={},i={};return Object.keys(t).forEach(function(e){b[e]||(b[e]=t[e],o[e]=t[e])}),Object.keys(n).forEach(function(e){k[e]||(k[e]=n[e],i[e]=n[e])}),{links:i,nodes:o}}function i(){t.isEmptyObj(m)||m.close(4999)}function r(){var e;e=UIkit.modal("#modal_traceroute")[0],e.isActive()&&e.toggle("close")}function a(){var e=$("#newSide");e.is(":visible")&&e.toggle("slide")}function c(){e.clear(),r(),a()}function s(e){var n=h;console.log("Connection open..."),S.init.close(),v.success("Socket connected."),S.processing=v.process("Waiting for socket messages...",0),t.isFn(n)&&n()}function d(n){var i;if(O+=1,1===O&&c(),t.isStr(n.data)){console.log("String message received\n"),v.success("New socket message received."),i=JSON.parse(n.data),console.log(i),i=o(i);var r=Object.keys(i.nodes).length,a=Object.keys(i.links).length;console.log(r,a),w={x:e.width/380,y:e.height/380},1===O?(console.log("fud"),e.draw(i,"viewport",void 0,w,!0)):e.draw(i,"viewport",void 0,w)}else console.log("Other message received\n",n.data)}function u(e){console.log("WebSocket Error: ",e),r(),S.init.close(),v.error("Socket error.")}function f(e){console.log("Connection closed",e),n.enable(j),S.init.close();var t=S.processing;t&&t.close(),v.info("Socket closed.",2e3)}function l(e){h=e,m.onopen=s,m.onmessage=d,m.onerror=u,m.onclose=f}function p(e){e&&(y+="?portscanner=true"),m=new WebSocket(y),console.log(m)}function g(e,t){S.init=n.note.process("Opening socket...",!1,"top-center"),j=$("#traceroute_scan"),E=$("#traceroute_scan"),n.disable(j),p(t),l(function(){m.send(JSON.stringify(e))})}var h,v=n.note,m={},y="ws://"+baseRoot+"/network/icmp/traceroute",w={},b={},k={},O=0,S={},j={},E={};return{abort:i,trace:g}}),define("core/mockTrace",["map/mediator","core/wuk","core/util"],function(e,n,t){function o(n){r.success("New socket message received.");var t=n;a+=1,1===a?e.draw(t,"viewport",void 0,void 0,!0):e.draw(t,"viewport",void 0,void 0)}function i(){var e=io.connect("ws://127.0.0.1:2000");e.on("server msg",o),e.emit("start sending")}var r=n.note,a=0;return{trace:i}}),define("core/page",["map/mediator","./wuk","./whb","./discovery","./traceroute","./mockTrace"],function(e,n,t,o,i,r){function a(e){var t=e,i=t.val(),r=!1,a=$("#discovery_start");r=o.isValidIp(i),e.removeClass("uk-form-success uk-form-danger"),r?(t.addClass("uk-form-success"),n.enable(a)):(t.addClass("uk-form-danger"),n.disable(a))}function c(r,c){r.apply(void 0,c),t.compileAll();var s=$("#newSide");s.css({height:window.innerHeight}),$(window).on("resize",function(){var e=(window.innerWidth,window.innerHeight);s.css({height:e})}),a($("#disc_left_input")),a($("#disc_right_input")),$("#clear").on("click",function(n){n.preventDefault(),e.clear()}),$("#sidebar_btn").on("click",function(){this.closed=!this.closed;var e=$("#newSide");e.is(":animated")||e.toggle("slide")}),$("#traceroute_scan").on("click",function(e){var n,t,o,r;e.preventDefault(),n=$("#txtarea_thing"),t=$('input[type="checkbox"][name="secure"]').is(":checked"),o=n.val().trim(),o&&(r=o.split("\n"),i.trace(r,t)),$("#abort").removeAttr("disabled")}),$("#abort").on("click",function(e){e.preventDefault(),i.abort()}),$("#discovery_start").on("click",function(){var e,n,t;e=$('input[type="text"][name="first-input"]').val(),n=$('input[type="text"][name="second-input"]').val(),e=e?e.trim():"",n=n?n.trim():"",t=$('#modal-discovery input[type="radio"][name="radio1"]:checked').val(),o.discover(e,n,parseInt(t,10))}),$(".j-discovery-radios").on("click",function(){var e,n,t=parseInt(this.value,10);e=$('input[type="text"][name="first-input"]'),n=$('input[type="text"][name="second-input"]'),t?(e.val("192.168.1.1"),n.val("255.255.255.0")):(e.val("192.168.1.1"),n.val("192.168.1.255")),a($("#disc_left_input")),a($("#disc_right_input"))}),$("#disc_left_input").on("keyup",function(){a($(this))}),$("#disc_right_input").on("keyup",function(){a($(this))}),$("#popups").on("click",".j-popup-close",function(e){e.preventDefault(),$(this).parent().remove()}),$(document).on("keydown",function(e){var t;27===e.keyCode&&(n.isAnyModalActive()||(t=$("#newSide"),t.is(":animated")||t.toggle("slide")))}),$('div[id^="modal_"]').on("beforeshow",function(e){n.modalState(!0,e.target.id)}),$('div[id^="modal_"]').on("hide",function(e){n.modalState(!1,e.target.id)})}var s={};return s.addEvt=c,s}),define("core/mediator",["./page","map/mediator"],function(e,n){function t(){e.addEvt(n.init,["visMap","#map_container"])}var o={};return o.init=t,o});var baseRoot="192.168.10.13:3000",t;require.config({baseUrl:"js/",paths:{lib:"lib",core:"core",map:"map"}}),require(["core/mediator"],function(e){$(function(){e.init()})}),define("main",function(){});