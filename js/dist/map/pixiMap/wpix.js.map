{"version":3,"sources":["../../../src/map/pixiMap/wpix.js"],"names":["define","u","newPubSub","inst","extend","p","renderer","stage","mainContainer","viewport","xSec1","xSec2","ySec1","ySec2","textures","zoom","events","zoomLevel","MAX_ZOOM_OUT","MAX_ZOOM_IN","init","o","callback","panBounds","background","div","containerDiv","jQuery","isStr","$","undefined","renW","renH","renReso","pan","setBounds","PIXI","utils","skipHello","autoDetectRenderer","window","innerWidth","innerHeight","backgroundColor","antialias","Container","width","height","resolution","append","view","interactive","hitArea","Rectangle","add","on","mousewheel","e","preventDefault","createContainers","addChild","loader","load","resources","isFn","requestAnimationFrame","animate","render","emit","zoomIn","deltaY","mcPos","prevPos","pageX","pageY","main","el","lineContainer","nodeContainer","clearContainer","k","r","children","destroy","str","child","i","coPoint","x","y","Point","direction","factor","local_pt","point","interaction","InteractionData","prototype","getLocalPosition","scale","pivot","position","isDragging","prevX","prevY","bounds","down","pos","data","global","move","dx","dy","mcX","mcY","bX1","x1","bX2","x2","bY1","y1","bY2","y2","negate","negateNum","posit","positNum","up","X_1","X_2","Y_1","Y_2","get","create2pointLine","conf","line","start","end","lineWidth","tmpLineWidth","alpha","color","handlers","setThings","isNum","calcPoints","setStart","s","setEnd","setLineWidth","w","setColor","c","increaseWidth","redraw","defaultWidth","clear","draw","toggleDirties","stopPropagation","execute","over","out","rightup","ctx","handler","fn","param","apply","concat","addEvents","dirty","clearDirty","half","sLeft","sRight","eRight","eLeft","sX","sY","eX","eY","results","changeColor","changePoints","bringToFront","container","arr","parent","splice","indexOf","push","beginFill","moveTo","lineTo","endFill","createElement","Graphics","buttonMode","lineStyle","create","setHandler","evt","Object","defineProperty","createBoxSpriteText","sprite","text","box","imgFill","imgBasePath","imgName","imgExt","img","spriteImg","spriteScale","spriteTint","textContent","textFont","textSize","textColor","boxX","boxY","boxAlpha","counter","dragging","dragPoint","newPosition","makeSprite","Sprite","anchor","set","tint","makeText","Text","fontFamily","fontSize","fill","makeBox","changeTint","n","defineProperties","v","wpix"],"mappings":"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","file":"wpix.js","sourcesContent":["define([\"core/util\", \"core/pubsub\"], function (u, newPubSub) {\r\n\tvar inst = u.extend( newPubSub() ),\r\n\t\tp = {};\r\n\t\r\n\tp.renderer = {};\r\n\tp.stage = {};\r\n\tp.mainContainer = {};\r\n\t\r\n\tp.viewport = {};\r\n\tp.xSec1 = {};\r\n\tp.xSec2 = {};\r\n\tp.ySec1 = {};\r\n\tp.ySec2 = {};\r\n\t\r\n\tp.textures = {};\r\n\tp.zoom = true;\r\n\tp.events = true;\r\n\t\r\n\tp.zoomLevel = 0;\r\n\tp.MAX_ZOOM_OUT = -12;\r\n\tp.MAX_ZOOM_IN = 8;\r\n\t\r\n\tfunction init(o) {\r\n\t\to = o ? o : {};\r\n\t\tvar callback = o.callback,\r\n\t\t\tpanBounds = o.panBounds,\r\n\t\t\tbackground = o.background,\r\n\t\t\tdiv = o.containerDiv;\r\n\t\t\tdiv = div instanceof jQuery ? div : u.isStr(div) ? $(div) : undefined;\r\n\t\t\r\n\t\tvar renderer, renW, renH, renReso, stage, mainContainer;\r\n\t\t\r\n\t\tpan.setBounds(panBounds);\r\n\t\tPIXI.utils.skipHello();\r\n\t\tp.renderer = PIXI.autoDetectRenderer(\r\n\t\t\twindow.innerWidth,\r\n\t\t\twindow.innerHeight,\r\n\t\t\t{\r\n\t\t\t\tbackgroundColor: background || 0xAB9988, // 0xAB9999,\r\n\t\t\t\tantialias: true,\r\n\t\t//\t\tresolution: false,\r\n\t\t//\t\ttransparent: false,\r\n\t\t//\t\tpreserveDrawingBuffer: false,\r\n\t\t//\t\tview: HTMLCanvasElement\r\n\t\t\t}\r\n\t\t//\tnoWebGL: false,                    // optional\r\n\t\t);\r\n\t\t\r\n\t\tp.stage = new PIXI.Container();\r\n\t\tp.mainContainer = new PIXI.Container();\r\n\t\t\r\n\t\trenderer = p.renderer;\r\n\t\trenW = renderer.width;\r\n\t\trenH = renderer.height;\r\n\t\trenReso = renderer.resolution;\r\n\t\tstage = p.stage;\r\n\t\tmainContainer = p.mainContainer;\r\n\t\t\r\n\t\t// document.body.appendChild( p.renderer.view );\r\n\t\tdiv.append( renderer.view );\r\n\t\t\r\n\t\t//p.stage.buttonMode = true;\r\n\t\tmainContainer.interactive = true;\r\n\t\tmainContainer.hitArea = new PIXI.Rectangle( -100000, -100000, renW / renReso * 100000, renH / renReso *100000 );\r\n\t\tpan.add( mainContainer );\r\n\t\t\r\n\t\t$(\"canvas\").on({\r\n\t\t\t\"mousewheel\": mousewheel,\r\n\t\t\t\"mouseout\": function () {\r\n\t\t\t\tp.events = false;\r\n\t\t\t},\r\n\t\t\t\"mouseover\": function () {\r\n\t\t\t\tp.events = true;\r\n\t\t\t},\r\n\t\t\t\"contextmenu\": function (e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\t\t});\r\n\t\t$('#contextmenu').on('contextmenu', function (e) {\r\n\t\t\te.preventDefault(); // ctxmenu_wrap\r\n\t\t});\r\n\t\t\r\n\t\tcreateContainers();\r\n\t\tstage.addChild( mainContainer );\r\n\t\t\r\n\t\t// PIXI.loader.add( \"images/atlas-0.json\" );\r\n\t\tPIXI.loader.add( \"images/n/atlas64.json\" );\r\n\t\tPIXI.loader.load(function () {\r\n\t\t\t// p.textures = PIXI.loader.resources[\"images/atlas-0.json\"].textures;\r\n\t\t\tp.textures = PIXI.loader.resources[\"images/n/atlas64.json\"].textures;\r\n\t\t\tif ( u.isFn(callback) ) {\r\n\t\t\t\tcallback(renW, renH);\r\n\t\t\t}\r\n\t\t});\r\n\t\trequestAnimationFrame( animate );\r\n\t\trenderer.render( mainContainer );\r\n\t\tinst.emit(\"init\");\r\n\t}\r\n\t\r\n\tfunction mousewheel(e) {\r\n\t\tvar zoomIn,\r\n\t\t\tdeltaY = e.deltaY,\r\n\t\t\tmcPos, prevPos,\r\n\t\t\tzoomLevel;\r\n\t\t\t\r\n\t\tp.zoomLevel += deltaY;\r\n\t\tzoomLevel = p.zoomLevel;\r\n\t\t\r\n\t\t/* e.deltaX, e.deltaY, e.deltaFactor\r\n\t\tzoom(e.pageX, e.pageY, e.deltaY > 0);\r\n\t\tzoom(e); */\r\n\t\t\r\n\t\t\r\n\t\t/* if (p.zoom) {\r\n\t\t\tzoomIn = deltaY > 0;\r\n\t\t\t\r\n\t\t\tif (zoomLevel > p.MAX_ZOOM_OUT  &&  zoomLevel < p.MAX_ZOOM_IN) {\r\n\t\t\t\tmcPos = p.mainContainer.position;\r\n\t\t\t\tprevPos = {x: mcPos.x, y: mcPos.y};\r\n\t\t\t\t\r\n\t\t\t\tzoom(e.pageX, e.pageY, zoomIn);\r\n\t\t\t\t\r\n\t\t\t\tinst.emit(\"zoom\", {\r\n\t\t\t\t\tzoomIn: zoomIn,\r\n\t\t\t\t\tpos: mcPos\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tif (zoomIn) {\r\n\t\t\t\t\tp.zoomLevel = p.MAX_ZOOM_IN;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tp.zoomLevel = p.MAX_ZOOM_OUT;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} */\r\n\t\tzoomIn = deltaY > 0;\r\n\t\tzoom(e.pageX, e.pageY, zoomIn);\r\n\t}\r\n\tfunction createContainers() {\r\n\t\tvar viewport, xSec1, xSec2, ySec1, ySec2,\r\n\t\t\tmain = p.mainContainer;\r\n\t\t\r\n\t\tviewport = new PIXI.Container();\r\n\t\txSec1    = new PIXI.Container();\r\n\t\txSec2    = new PIXI.Container();\r\n\t\tySec1    = new PIXI.Container();\r\n\t\tySec2    = new PIXI.Container();\r\n\t\t\r\n\t\tadd( viewport );\r\n\t\tadd( xSec1    );\r\n\t\tadd( xSec2   );\r\n\t\tadd( ySec1     );\r\n\t\tadd( ySec2    );\r\n\t\t\r\n\t\tmain.addChild( viewport );\r\n\t\tmain.addChild( xSec1    );\r\n\t\tmain.addChild( xSec2   );\r\n\t\tmain.addChild( ySec1     );\r\n\t\tmain.addChild( ySec2    );\r\n\t\t\r\n\t\tp.viewport = viewport;\r\n\t\tp.xSec1    = xSec1;\r\n\t\tp.xSec2    = xSec2;\r\n\t\tp.ySec1    = ySec1;\r\n\t\tp.ySec2    = ySec2;\r\n\t}\r\n\tfunction add(el) {\r\n\t\tvar lineContainer = new PIXI.Container(),\r\n\t\t\tnodeContainer = new PIXI.Container();\r\n\t\tel.addChild(lineContainer);\r\n\t\tel.addChild(nodeContainer);\r\n\t}\r\n\tfunction clearContainer(k) {\r\n\t\tvar r = p[k];\r\n\t\tr.children[0].destroy(true); // lineContainer\r\n\t\tr.children[0].destroy();     // nodeContainer\r\n\t\tadd(r);\r\n\t}\r\n\tfunction addChild(k, str, child) {\r\n\t\tvar i;\r\n\t\tif (str === \"lineContainer\") {\r\n\t\t\ti = 0;\r\n\t\t} else if (str === \"nodeContainer\") {\r\n\t\t\ti = 1;\r\n\t\t}\r\n\t\tp[k].children[i].addChild(child);\r\n\t}\r\n\tfunction animate() {\r\n\t\trequestAnimationFrame(animate);\r\n\t\t//tink.update();\r\n\t\t//TWEEN.update();\r\n\t\tp.renderer.render(p.stage);\r\n\t}\r\n\tfunction coPoint(x, y) {\r\n\t\treturn new PIXI.Point(x, y);\r\n\t}\r\n\tfunction zoom(x, y, zoomIn) {\r\n\t\tvar direction = (zoomIn) ? 1 : -1,\r\n\t\t\tfactor = (1 + direction * 0.05),\r\n\t\t\tlocal_pt = new PIXI.Point(),\r\n\t\t\tpoint = new PIXI.Point(x, y),\r\n\t\t\tmainContainer = p.mainContainer;\r\n\t\t\r\n\t\tPIXI.interaction.InteractionData.prototype.getLocalPosition(mainContainer, local_pt, point);\r\n\t\t\r\n\t\tmainContainer.scale.x *= factor;\r\n\t\tmainContainer.scale.y *= factor;\r\n\t\tmainContainer.pivot = local_pt;\r\n\t\tmainContainer.position = point;\r\n\t}\r\n\tvar pan = (function () {\r\n\t\tvar isDragging = false,\r\n\t\t\tprevX,\r\n\t\t\tprevY,\r\n\t\t\tbounds = {};\r\n\t\t\r\n\t\tfunction down(e) {\r\n\t\t\tisDragging = true;\r\n\t\t\t//downX = e.data.global.x;\r\n\t\t\t//downY = e.data.global.y;\r\n\t\t\t\r\n\t\t\tvar pos = e.data.global;\r\n\t\t\tprevX = pos.x;\r\n\t\t\tprevY = pos.y;\r\n\t\t\tisDragging = true;\r\n\t\t}\r\n\t\tfunction move(e) {\r\n\t\t\tif ( !isDragging ) { return; }\r\n\t\t\tvar pos = e.data.global,\r\n\t\t\t\tdx = pos.x - prevX,\r\n\t\t\t\tdy = pos.y - prevY,\r\n\t\t\t\tmcX = p.mainContainer.position.x,\r\n\t\t\t\tmcY = p.mainContainer.position.y,\r\n\t\t\t\tbX1 = bounds.x1,\r\n\t\t\t\tbX2 = bounds.x2,\r\n\t\t\t\tbY1 = bounds.y1,\r\n\t\t\t\tbY2 = bounds.y2,\r\n\t\t\t\tnegate = u.negateNum,\r\n\t\t\t\tposit = u.positNum;\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tif (mcX <= bX1    &&    mcX >= bX2) {\r\n\t\t\t\tp.mainContainer.position.x += dx;\r\n\t\t\t\tinst.emit(\"inboundPanX\", dx);\r\n\t\t\t} else {\r\n\t\t\t\tp.mainContainer.position.x = mcX > 0 ? bX1 : mcX < 0 ? bX2 : undefined;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (mcY <= bY1    &&    mcY >= bY2) {\r\n\t\t\t\tp.mainContainer.position.y += dy;\r\n\t\t\t\tinst.emit(\"inboundPanY\", dy);\r\n\t\t\t} else {\r\n\t\t\t\tp.mainContainer.position.y = mcY > 0 ? bY1 : mcY < 0 ? bY2 : undefined;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tprevX = pos.x;\r\n\t\t\tprevY = pos.y;\r\n\t\t\t\r\n\t\t\tinst.emit(\"pan\", p.mainContainer.position);\r\n\t\t}\r\n\t\tfunction up(e) {\r\n\t\t\tisDragging= false;\r\n\t\t\tinst.emit(\"stageClick\", e.data.global);\r\n\t\t}\r\n\t\tfunction pan(x, y) {\r\n\t\t\tif ( x  &&  y ) {\r\n\t\t\t\tp.mainContainer.position.x += x;\r\n\t\t\t\tp.mainContainer.position.y += y;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction add(el) {\r\n\t\t\tel\r\n\t\t\t\t.on(\"mousedown\", down)\r\n\t\t\t\t.on(\"touchstart\", down)\r\n\t\t\t\t.on(\"mouseup\", up)\r\n\t\t\t\t.on(\"mouseupoutside\", up)\r\n\t\t\t\t.on(\"touchend\", up)\r\n\t\t\t\t.on(\"touchendoutside\", up)\r\n\t\t\t\t.on(\"mousemove\", move)\r\n\t\t\t\t.on(\"touchmove\", move);\r\n\t\t}\r\n\t\tfunction setBounds(o) {\r\n\t\t\to = o ? o : {};\r\n\t\t\tvar posit = u.positNum,\r\n\t\t\t\tnegate = u.negateNum;\r\n\t\t\t\t\r\n\t\t\t// changing bound signs for easier calculation later.\r\n\t\t\tbounds.x1 = posit(o.X_1);\r\n\t\t\tbounds.x2 = negate(o.X_2);\r\n\t\t\tbounds.y1 = posit(o.Y_1);\r\n\t\t\tbounds.y2 = negate(o.Y_2);\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\tget: function () { return bounds; },\r\n\t\t\tsetBounds: setBounds,\r\n\t\t\tpan: pan,\r\n\t\t\tadd: add\r\n\t\t};\r\n\t}());\r\n\tfunction create2pointLine(conf) {\r\n\t\tconf = conf ? conf : {};\r\n\t\t\r\n\t\tvar line,\r\n\t\t\tstart, end,\r\n\t\t\tlineWidth, tmpLineWidth,\r\n\t\t\talpha, color,\r\n\t\t\tp,\r\n\t\t\thandlers = {};\r\n\t\t\r\n\t\tfunction setThings() {\r\n\t\t\tstart     =  conf.start     ||  {x: 0, y: 0};\r\n\t\t\tend       =  conf.end       ||  {x: 0, y: 0};\r\n\t\t\tlineWidth =  conf.lineWidth ||  2;\r\n\t\t\tcolor     =  conf.color     ||  0x000000;\r\n\t\t\talpha     =  conf.alpha;\r\n\t\t\talpha     =  u.isNum(alpha) ? alpha : 1;\r\n\t\t\tp         =  calcPoints();\r\n\t\t}\r\n\t\tfunction setStart(s) {\r\n\t\t\tif (s) {\r\n\t\t\t\tstart = s;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction setEnd(e) {\r\n\t\t\tif (e) {\r\n\t\t\t\tend = e;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction setLineWidth(w) {\r\n\t\t\tif (w) {\r\n\t\t\t\tlineWidth = w;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction setColor(c) {\r\n\t\t\tif (c) {\r\n\t\t\t\tcolor = c;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction increaseWidth(factor) {\r\n\t\t\tfactor = u.isNum(factor) && factor ? factor : 4;\r\n\t\t\t// console.log(\"hover\");\r\n\t\t\ttmpLineWidth = lineWidth;\r\n\t\t\tlineWidth *= factor;\r\n\t\t\tredraw();\r\n\t\t}\r\n\t\tfunction defaultWidth() {\r\n\t\t\t// console.log(\"unhover\");\r\n\t\t\tlineWidth = tmpLineWidth;\r\n\t\t\tredraw();\r\n\t\t}\r\n\t\tfunction redraw() {\r\n\t\t\tp = calcPoints();\r\n\t\t\tline.clear();\r\n\t\t\tdraw();\r\n\t\t\ttoggleDirties();\r\n\t\t}\r\n\t\tfunction down(e) {\r\n\t\t\te.stopPropagation();\r\n\t\t\tthis.alpha = 0.5;\r\n\t\t\t\r\n\t\t\texecute(\"mousedown\", e, this);\r\n\t\t}\r\n\t\tfunction up(e) {\r\n\t\t\te.stopPropagation();\r\n\t\t\tthis.alpha = 1;\r\n\t\t\t\r\n\t\t\texecute(\"mouseup\", e, this);\r\n\t\t}\r\n\t\tfunction over() {\r\n\t\t\t// hover();\r\n\t\t}\r\n\t\tfunction out() {\r\n\t\t\t// unhover();\r\n\t\t}\r\n\t\tfunction rightup(e) {\r\n\t\t\texecute(\"rightup\", e, this);\r\n\t\t}\r\n\t\tfunction execute(str, e, ctx) {\r\n\t\t\tvar handler = handlers[str] || {}, \r\n\t\t\t\tfn = handler.fn,\r\n\t\t\t\tparam = handler.param;\r\n\t\t\tif ( u.isFn(fn) ) {\r\n\t\t\t\tfn.apply(ctx, param ? [e].concat(param) : [e]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction addEvents() {\r\n\t\t\tline\r\n\t\t\t\t.on(\"mousedown\", down) \r\n\t\t\t\t.on(\"touchstart\", down)\r\n\t\t\t\t.on(\"mouseup\", up)\r\n\t\t\t\t.on(\"mouseupoutside\", up)\r\n\t\t\t\t.on(\"touchend\", up)\r\n\t\t\t\t.on(\"touchendoutside\", up)\r\n\t\t\t//\t.on(\"mousemove\", move)\r\n\t\t\t//\t.on(\"touchmove\", move)\r\n\t\t\t\t.on(\"mouseover\", over)\r\n\t\t\t\t.on(\"mouseout\", out)\r\n\t\t\t\t.on(\"rightup\", rightup);\r\n\t\t}\r\n\t\tfunction toggleDirties() {\r\n\t\t\tvar dirty = line.dirty,\r\n\t\t\t\tclearDirty = line.clearDirty;\r\n\t\t\t\r\n\t\t\tdirty = dirty ? false : true;\r\n\t\t\tclearDirty = clearDirty ? false : true;\r\n\t\t}\r\n\t\tfunction calcPoints() {\r\n\t\t\tvar half = lineWidth / 2,\r\n\t\t\t\tsLeft = {},\r\n\t\t\t\tsRight = {},\r\n\t\t\t\teRight = {},\r\n\t\t\t\teLeft = {},\r\n\t\t\t\tsX = start.x,\r\n\t\t\t\tsY = start.y,\r\n\t\t\t\teX = end.x,\r\n\t\t\t\teY = end.y,\r\n\t\t\t\tresults = {};\r\n\r\n\t\t\tif ( (sX < eX  &&  sY < eY)  || // topLeft to bottRight\r\n\t\t\t\t\t(sX > eX  &&  sY > eY) ) { // bottRight to topLeft\r\n\t\t\t\tsLeft = new PIXI.Point( sX-half, sY+half );\r\n\t\t\t\tsRight = new PIXI.Point( sX+half, sY-half );\r\n\t\t\t\teRight = new PIXI.Point( eX+half, eY-half );\r\n\t\t\t\teLeft = new PIXI.Point( eX-half, eY+half );\r\n\t\t\t} else if ( (sX > eX  &&  sY < eY) || // topRight to bottLeft\r\n\t\t\t\t\t(sX < eX  &&  sY > eY) ) { // bottLeft to topRight\r\n\t\t\t\tsLeft = new PIXI.Point( sX-half, sY-half );\r\n\t\t\t\tsRight = new PIXI.Point( sX+half, sY+half );\r\n\t\t\t\teRight = new PIXI.Point( eX+half, eY+half );\r\n\t\t\t\teLeft = new PIXI.Point( eX-half, eY-half );\r\n\t\t\t} else if ( sX === eX  &&\r\n\t\t\t\t\t(sY > eY  ||  sY < eY) ) { // vertical\r\n\t\t\t\tsLeft = new PIXI.Point( sX-half, sY );\r\n\t\t\t\tsRight = new PIXI.Point( sX+half, sY);\r\n\t\t\t\teRight = new PIXI.Point( eX+half, eY );\r\n\t\t\t\teLeft = new PIXI.Point( eX-half, eY );\r\n\t\t\t\t\r\n\t\t\t} else if ( sY === eY  &&\r\n\t\t\t\t\t(sX < eX  ||  sX > eX) ) { // horizontal\r\n\t\t\t\tsLeft = new PIXI.Point( sX, sY+half );\r\n\t\t\t\tsRight = new PIXI.Point( sX, sY-half );\r\n\t\t\t\teRight = new PIXI.Point( eX, eY-half );\r\n\t\t\t\teLeft = new PIXI.Point( eX, eY+half );\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tresults.sLeft = sLeft;\r\n\t\t\tresults.sRight = sRight;\r\n\t\t\tresults.eRight = eRight;\r\n\t\t\tresults.eLeft = eLeft;\r\n\t\t\t\r\n\t\t\treturn results;\r\n\t\t}\r\n\t\tfunction changeColor(c) {\r\n\t\t\tsetColor(c);\r\n\t\t\tline.clear();\r\n\t\t\tdraw();\r\n\t\t\ttoggleDirties();\r\n\t\t}\r\n\t\tfunction changePoints(s, e) {\r\n\t\t\tsetStart(s);\r\n\t\t\tsetEnd(e);\r\n\t\t\tp = calcPoints();\r\n\t\t\tline.clear();\r\n\t\t\tdraw();\r\n\t\t\ttoggleDirties();\r\n\t\t}\r\n\t\tfunction bringToFront(container) {\r\n\t\t\tvar el = line,\r\n\t\t\t\tarr = el.parent.children;\r\n\t\t\t\r\n\t\t\tarr.splice( arr.indexOf(el), 1 );\r\n\t\t\tarr.push(el);\r\n\t\t}\r\n\t\tfunction draw() {\r\n\t\t\tline.beginFill( color );\r\n\t\t\tline.moveTo( p.sLeft.x, p.sLeft.y );\r\n\t\t\tline.lineTo( p.sRight.x, p.sRight.y );\r\n\t\t\tline.lineTo( p.eRight.x, p.eRight.y );\r\n\t\t\tline.lineTo( p.eLeft.x, p.eLeft.y );\r\n\t\t\tline.endFill();\r\n\t\t}\r\n\t\tfunction createElement() {\r\n\t\t\tvar line;\r\n\t\t\t\r\n\t\t\tline = new PIXI.Graphics();\r\n\t\t\tline.interactive = true;\r\n\t\t\tline.buttonMode = true;\r\n\t\t\tline.lineStyle(0);\r\n\t\t\t\r\n\t\t\treturn line;\r\n\t\t}\r\n\t\tfunction create() {\r\n\t\t\tline = createElement();\r\n\t\t\taddEvents( line );\r\n\t\t\tdraw();\r\n\t\t}\r\n\t\t\r\n\t\tsetThings();\r\n\t\tcreate();\r\n\t\tline.alpha = alpha;\r\n\t\t\r\n\t\tline.setHandler = function (evt, fn, param) {\r\n\t\t\thandlers[evt] = {\r\n\t\t\t\tfn: fn,\r\n\t\t\t\tparam: param\r\n\t\t\t};\r\n\t\t};\r\n\t\tline.changePoints = changePoints;\r\n\t\tline.changeColor = changeColor;\r\n\t\tline.bringToFront = bringToFront;\r\n\t\tline.increaseWidth = increaseWidth;\r\n\t\tline.defaultWidth = defaultWidth;\r\n\t\tObject.defineProperty(line, \"points\", {\r\n\t\t\tget: function () { return {start: start, end: end}; }\r\n\t\t});\r\n\t\t\r\n\t\treturn line;\r\n\t}\r\n\tfunction createBoxSpriteText(conf) {\r\n\t\tconf = conf ? conf : {};\r\n\t\tvar sprite,\r\n\t\t\ttext,\r\n\t\t\tbox,\r\n\t\t\timgFill, imgBasePath, imgName, imgExt, img,\r\n\t\t\tspriteImg, spriteScale, spriteTint,\r\n\t\t\ttextContent, textFont, textSize, textColor,\r\n\t\t\tboxX, boxY, boxAlpha,\r\n\t\t\thandlers = {},\r\n\t\t\tcounter = 0;\r\n\t\t\r\n\t\tfunction setThings() {\r\n\t\t\timgFill     = conf.imgFill      || false;\r\n\t\t//\timgBasePath = conf.imgBasePath  || \"images/raw/edited/\"; // images/\r\n\t\t\timgName     = conf.imgName      || \"0\"; // \"tv-screen\"; // tv-screen computer\r\n\t\t\timgExt      = conf.imgExt       || \".png\";\r\n\t\t\tspriteScale = conf.spriteScale  || 0.2;\r\n\t\t\tspriteTint  = conf.spriteTint   || false;\r\n\t\t\ttextContent = conf.textContent  || \"no_name\";\r\n\t\t\ttextFont    = conf.textFont     || \"Arial\";\r\n\t\t\ttextSize    = conf.textSize     || \"16px\";\r\n\t\t\ttextColor   = conf.textColor    || \"black\";\r\n\t\t\tboxX        = conf.x            || 0;\r\n\t\t\tboxY        = conf.y            || 0;\r\n\t\t\tboxAlpha    = conf.boxAlpha;\r\n\t\t\tboxAlpha    = u.isNum(boxAlpha) ? boxAlpha : 1;\r\n\t\t//\tspriteImg   = conf.spriteImg    || imgBasePath + imgName + (imgFill ? \"-fill\":\"-trans\") + imgExt;\r\n\t\t//\tspriteImg   = conf.spriteImg    || imgName + (imgFill ? \"-fill\" : \"-trans\") + imgExt;\r\n\t\t\tspriteImg   = conf.spriteImg    || imgName + imgExt;\r\n\t\t}\r\n\t\tfunction bringToFront() {\r\n\t\t\tvar el = box\r\n\t\t\t\tarr = el.parent.children;\r\n\t\t\t\t\r\n\t\t\tarr.splice( arr.indexOf(el), 1 );\r\n\t\t\tarr.push(el);\r\n\t\t}\r\n\t\tfunction down(e) {\r\n\t\t\te.stopPropagation();\r\n\t\t\tthis.data = e.data;\r\n\t\t\tthis.alpha = 0.5;\r\n\t\t\tthis.dragging = true;\r\n\t\t\tthis.dragPoint = e.data.getLocalPosition(this.parent);\r\n\t\t\tthis.dragPoint.x -= this.position.x;\r\n\t\t\tthis.dragPoint.y -= this.position.y;\r\n\t\t\t\r\n\t\t\texecute(\"mousedown\", e, this);\r\n\t\t}\r\n\t\tfunction up(e) {\r\n\t\t\te.stopPropagation();\r\n\t\t\tthis.alpha = 1;\r\n\t\t\tthis.dragging = false;\r\n\t\t\tthis.data = null;\r\n\t\t\t\r\n\t\t\texecute(\"mouseup\", e);\r\n\t\t}\r\n\t\tfunction move(e) {\r\n\t\t\tif ( this.dragging ) {\r\n\t\t\t\tvar newPosition = this.data.getLocalPosition(this.parent);\r\n\t\t\t\tthis.position.x = newPosition.x - this.dragPoint.x;\r\n\t\t\t\tthis.position.y = newPosition.y - this.dragPoint.y;\r\n\t\t\t\t\r\n\t\t\t\texecute(\"mousemove\", e, this);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction over(e) {\r\n\t\t\tif(!this.dragging) {\r\n\t\t\t\texecute(\"mouseover\", e, this);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction out(e) {\r\n\t\t\tif(!this.dragging) {\r\n\t\t\t\texecute(\"mouseout\", e, this);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction rightup(e) {\r\n\t\t\texecute(\"rightup\", e, this);\r\n\t\t}\r\n\t\tfunction execute(str, e, ctx) {\r\n\t\t\tvar handler = handlers[str] || {},\r\n\t\t\t\tfn = handler.fn,\r\n\t\t\t\tparam = handler.param;\r\n\t\t\tif ( u.isFn(fn) ) {\r\n\t\t\t\tfn.apply(ctx, param ? [e].concat(param) : [e]);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction addEvents(el) {\r\n\t\t\tel\r\n\t\t\t\t.on(\"mousedown\", down) \r\n\t\t\t\t.on(\"touchstart\", down)\r\n\t\t\t\t.on(\"mouseup\", up)\r\n\t\t\t\t.on(\"mouseupoutside\", up)\r\n\t\t\t\t.on(\"touchend\", up)\r\n\t\t\t\t.on(\"touchendoutside\", up)\r\n\t\t\t\t.on(\"mousemove\", move)\r\n\t\t\t\t.on(\"touchmove\", move)\r\n\t\t\t\t.on(\"mouseover\", over)\r\n\t\t\t\t.on(\"mouseout\", out)\r\n\t\t\t\t.on('rightup', rightup);\r\n\t\t}\r\n\t\tfunction makeSprite() {\r\n\t\t\t// sprite = new PIXI.Sprite.fromImage( spriteImg );\r\n\t\t\tsprite = new PIXI.Sprite( p.textures[spriteImg] );\r\n\t\t\tsprite.interactive = true;\r\n\t\t\tsprite.buttonMode = true;\r\n\t\t\tsprite.anchor.set(0, 0);\r\n\t\t\tsprite.alpha = 1;\r\n\t\t\tsprite.scale.set( spriteScale );\r\n\t\t\tif (spriteTint) {\r\n\t\t\t\tif (spriteTint === 0) {\r\n\t\t\t\t\tsprite.tint = 0x4CAF50; // Green\r\n\t\t\t\t} else if (spriteTint === 1) {\r\n\t\t\t\t\tsprite.tint = 0x00FFFF; // Cyan\r\n\t\t\t\t} else if (spriteTint === 2) {\r\n\t\t\t\t\tsprite.tint = 0xFF9800; // Orange\r\n\t\t\t\t} else if (spriteTint === 3) {\r\n\t\t\t\t\tsprite.tint = 0x00FF00; // Yellow\r\n\t\t\t\t} else if (spriteTint === 4) {\r\n\t\t\t\t\tsprite.tint = 0x673AB7; // Purple\r\n\t\t\t\t} else if (spriteTint === 5) {\r\n\t\t\t\t\tsprite.tint = 0xFF0000; // Red\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// sprite.tint = 0xFFCC00 * spriteTint;\r\n\t\t\t}\r\n\t\t\tsprite.position.x = 0.5;\r\n\t\t\tsprite.position.y = 0.5;\r\n\t\t}\r\n\t\tfunction makeText() {\r\n\t\t\ttext = new PIXI.Text( textContent, {\r\n\t\t\t\tfontFamily: textFont,\r\n\t\t\t\tfontSize: textSize,\r\n\t\t\t\tfill: textColor\r\n\t\t\t});\r\n\t\t\ttext.interactive = true;\r\n\t\t\ttext.buttonMode = true;\r\n\t\t\ttext.y = sprite.y + sprite.height;\r\n\t\t}\r\n\t\tfunction makeBox() {\r\n\t\t\tbox = new PIXI.Container();\r\n\t\t\t// box = new PIXI.particles.ParticleContainer();\r\n\t\t\tbox.interactive = true;\r\n\t\t\tbox.buttonMode = true;\r\n\t\t\tbox.scale.set(1);\r\n\t\t\tbox.alpha = boxAlpha;\r\n\t\t\tbox.position.x = boxX;\r\n\t\t\tbox.position.y = boxY;\r\n\t\t\tbox.hitArea = new PIXI.Rectangle(0, 0, sprite.width, sprite.height);\r\n\t\t\taddEvents(box);\r\n\t\t\tbox.addChild(sprite); \r\n\t\t\tbox.addChild(text);\r\n\t\t}\r\n\t\t\r\n\t\tsetThings();\r\n\t\tmakeSprite();\r\n\t\tmakeText();\r\n\t\tmakeBox();\r\n\t\t\r\n\t\tbox.setHandler = function (evt, fn, param) {\r\n\t\t\thandlers[evt] = {\r\n\t\t\t\tfn: fn,\r\n\t\t\t\tparam: param\r\n\t\t\t};\r\n\t\t};\r\n\t\tbox.changeTint = function (n) {\r\n\t\t\tif (n) {\r\n\t\t\t\tsprite.tint = n;\r\n\t\t\t}\r\n\t\t};\r\n\t\tbox.bringToFront = bringToFront;\r\n\t\tbox.sprite = sprite;\r\n\t\t\r\n\t\treturn box;\r\n\t}\r\n\t\r\n\tObject.defineProperties(inst, {\r\n\t\t\"renderer\": {\r\n\t\t\tget: function () { return p.renderer; }\r\n\t\t},\r\n\t\t\"stage\": {\r\n\t\t\tget: function () { return p.stage; }\r\n\t\t},\r\n\t\t\"mainContainer\": {\r\n\t\t\tget: function () { return p.mainContainer; }\r\n\t\t},\r\n\t\t\"viewport\": {\r\n\t\t\tget: function () { return p.viewport; }\r\n\t\t},\r\n\t\t\"textures\": {\r\n\t\t\tget: function () { return p.textures; }\r\n\t\t},\r\n\t\t\"zoom\": {\r\n\t\t\tget: function () { return p.zoom; },\r\n\t\t\tset: function (v) { p.zoom = v; }\r\n\t\t},\r\n\t\t\"events\": {\r\n\t\t\tget: function () { return p.events; },\r\n\t\t\tset: function (v) { p.events = v; }\r\n\t\t}\r\n\t});\r\n\t\r\n\tinst.init = init;\r\n\tinst.coPoint = coPoint;\r\n\tinst.clearContainer = clearContainer;\r\n\tinst.addChild = addChild;\r\n\tinst.create2pointLine = create2pointLine;\r\n\tinst.createBoxSpriteText = createBoxSpriteText;\r\n\t\r\n\twindow.wpix = inst;\r\n\treturn inst;\r\n});"]}